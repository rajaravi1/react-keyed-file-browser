var yo=Object.create;var $=Object.defineProperty,Do=Object.defineProperties,Co=Object.getOwnPropertyDescriptor,So=Object.getOwnPropertyDescriptors,No=Object.getOwnPropertyNames,Ue=Object.getOwnPropertySymbols,Po=Object.getPrototypeOf,Ye=Object.prototype.hasOwnProperty,xo=Object.prototype.propertyIsEnumerable;var Pe=(t,e,r)=>e in t?$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r,u=(t,e)=>{for(var r in e||(e={}))Ye.call(e,r)&&Pe(t,r,e[r]);if(Ue)for(var r of Ue(e))xo.call(e,r)&&Pe(t,r,e[r]);return t},v=(t,e)=>Do(t,So(e)),_o=t=>$(t,"__esModule",{value:!0});var h=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),B=(t,e)=>{for(var r in e)$(t,r,{get:e[r],enumerable:!0})},ko=(t,e,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of No(e))!Ye.call(t,o)&&o!=="default"&&$(t,o,{get:()=>e[o],enumerable:!(r=Co(e,o))||r.enumerable});return t},ee=t=>ko(_o($(t!=null?yo(Po(t)):{},"default",t&&t.__esModule&&"default"in t?{get:()=>t.default,enumerable:!0}:{value:t,enumerable:!0})),t);var d=(t,e,r)=>(Pe(t,typeof e!="symbol"?e+"":e,r),r);var ie=h((Pl,tt)=>{function Eo(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}tt.exports=Eo});var Oe=h((xl,ot)=>{var Ko=ie(),rt=Object.create,Wo=function(){function t(){}return function(e){if(!Ko(e))return{};if(rt)return rt(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();ot.exports=Wo});var ne=h((_l,it)=>{function zo(){}it.exports=zo});var le=h((kl,nt)=>{var Go=Oe(),$o=ne();function se(t,e){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!e,this.__index__=0,this.__values__=void 0}se.prototype=Go($o.prototype);se.prototype.constructor=se;nt.exports=se});var lt=h((Tl,st)=>{function Ho(t,e){for(var r=-1,o=e.length,i=t.length;++r<o;)t[i+r]=e[r];return t}st.exports=Ho});var dt=h((Al,at)=>{var Uo=typeof global=="object"&&global&&global.Object===Object&&global;at.exports=Uo});var ae=h((Ol,ct)=>{var Yo=dt(),Jo=typeof self=="object"&&self&&self.Object===Object&&self,Xo=Yo||Jo||Function("return this")();ct.exports=Xo});var de=h((jl,pt)=>{var Vo=ae(),Qo=Vo.Symbol;pt.exports=Qo});var mt=h((ql,ut)=>{var ft=de(),ht=Object.prototype,Zo=ht.hasOwnProperty,ei=ht.toString,J=ft?ft.toStringTag:void 0;function ti(t){var e=Zo.call(t,J),r=t[J];try{t[J]=void 0;var o=!0}catch(n){}var i=ei.call(t);return o&&(e?t[J]=r:delete t[J]),i}ut.exports=ti});var Ft=h((Ll,gt)=>{var ri=Object.prototype,oi=ri.toString;function ii(t){return oi.call(t)}gt.exports=ii});var je=h((Il,vt)=>{var bt=de(),ni=mt(),si=Ft(),li="[object Null]",ai="[object Undefined]",wt=bt?bt.toStringTag:void 0;function di(t){return t==null?t===void 0?ai:li:wt&&wt in Object(t)?ni(t):si(t)}vt.exports=di});var ce=h((Ml,yt)=>{function ci(t){return t!=null&&typeof t=="object"}yt.exports=ci});var Ct=h((Rl,Dt)=>{var pi=je(),fi=ce(),hi="[object Arguments]";function ui(t){return fi(t)&&pi(t)==hi}Dt.exports=ui});var xt=h((Bl,Pt)=>{var St=Ct(),mi=ce(),Nt=Object.prototype,gi=Nt.hasOwnProperty,Fi=Nt.propertyIsEnumerable,bi=St(function(){return arguments}())?St:function(t){return mi(t)&&gi.call(t,"callee")&&!Fi.call(t,"callee")};Pt.exports=bi});var pe=h((El,_t)=>{var wi=Array.isArray;_t.exports=wi});var Ot=h((Kl,At)=>{var kt=de(),vi=xt(),yi=pe(),Tt=kt?kt.isConcatSpreadable:void 0;function Di(t){return yi(t)||vi(t)||!!(Tt&&t&&t[Tt])}At.exports=Di});var Lt=h((Wl,qt)=>{var Ci=lt(),Si=Ot();function jt(t,e,r,o,i){var n=-1,l=t.length;for(r||(r=Si),i||(i=[]);++n<l;){var s=t[n];e>0&&r(s)?e>1?jt(s,e-1,r,o,i):Ci(i,s):o||(i[i.length]=s)}return i}qt.exports=jt});var Mt=h((zl,It)=>{var Ni=Lt();function Pi(t){var e=t==null?0:t.length;return e?Ni(t,1):[]}It.exports=Pi});var Bt=h((Gl,Rt)=>{function xi(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}Rt.exports=xi});var Wt=h(($l,Kt)=>{var _i=Bt(),Et=Math.max;function ki(t,e,r){return e=Et(e===void 0?t.length-1:e,0),function(){for(var o=arguments,i=-1,n=Et(o.length-e,0),l=Array(n);++i<n;)l[i]=o[e+i];i=-1;for(var s=Array(e+1);++i<e;)s[i]=o[i];return s[e]=r(l),_i(t,this,s)}}Kt.exports=ki});var Gt=h((Hl,zt)=>{function Ti(t){return function(){return t}}zt.exports=Ti});var Ht=h((Ul,$t)=>{var Ai=je(),Oi=ie(),ji="[object AsyncFunction]",qi="[object Function]",Li="[object GeneratorFunction]",Ii="[object Proxy]";function Mi(t){if(!Oi(t))return!1;var e=Ai(t);return e==qi||e==Li||e==ji||e==Ii}$t.exports=Mi});var Yt=h((Yl,Ut)=>{var Ri=ae(),Bi=Ri["__core-js_shared__"];Ut.exports=Bi});var Vt=h((Jl,Xt)=>{var qe=Yt(),Jt=function(){var t=/[^.]+$/.exec(qe&&qe.keys&&qe.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Ei(t){return!!Jt&&Jt in t}Xt.exports=Ei});var Zt=h((Xl,Qt)=>{var Ki=Function.prototype,Wi=Ki.toString;function zi(t){if(t!=null){try{return Wi.call(t)}catch(e){}try{return t+""}catch(e){}}return""}Qt.exports=zi});var tr=h((Vl,er)=>{var Gi=Ht(),$i=Vt(),Hi=ie(),Ui=Zt(),Yi=/[\\^$.*+?()[\]{}|]/g,Ji=/^\[object .+?Constructor\]$/,Xi=Function.prototype,Vi=Object.prototype,Qi=Xi.toString,Zi=Vi.hasOwnProperty,en=RegExp("^"+Qi.call(Zi).replace(Yi,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function tn(t){if(!Hi(t)||$i(t))return!1;var e=Gi(t)?en:Ji;return e.test(Ui(t))}er.exports=tn});var or=h((Ql,rr)=>{function rn(t,e){return t==null?void 0:t[e]}rr.exports=rn});var Le=h((Zl,ir)=>{var on=tr(),nn=or();function sn(t,e){var r=nn(t,e);return on(r)?r:void 0}ir.exports=sn});var sr=h((ea,nr)=>{var ln=Le(),an=function(){try{var t=ln(Object,"defineProperty");return t({},"",{}),t}catch(e){}}();nr.exports=an});var ar=h((ta,lr)=>{function dn(t){return t}lr.exports=dn});var pr=h((ra,cr)=>{var cn=Gt(),dr=sr(),pn=ar(),fn=dr?function(t,e){return dr(t,"toString",{configurable:!0,enumerable:!1,value:cn(e),writable:!0})}:pn;cr.exports=fn});var hr=h((oa,fr)=>{var hn=800,un=16,mn=Date.now;function gn(t){var e=0,r=0;return function(){var o=mn(),i=un-(o-r);if(r=o,i>0){if(++e>=hn)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}fr.exports=gn});var mr=h((ia,ur)=>{var Fn=pr(),bn=hr(),wn=bn(Fn);ur.exports=wn});var Fr=h((na,gr)=>{var vn=Mt(),yn=Wt(),Dn=mr();function Cn(t){return Dn(yn(t,void 0,vn),t+"")}gr.exports=Cn});var wr=h((sa,br)=>{var Sn=Le(),Nn=ae(),Pn=Sn(Nn,"WeakMap");br.exports=Pn});var Dr=h((la,yr)=>{var vr=wr(),xn=vr&&new vr;yr.exports=xn});var Sr=h((aa,Cr)=>{function _n(){}Cr.exports=_n});var Ie=h((da,Pr)=>{var Nr=Dr(),kn=Sr(),Tn=Nr?function(t){return Nr.get(t)}:kn;Pr.exports=Tn});var _r=h((ca,xr)=>{var An={};xr.exports=An});var Me=h((pa,Tr)=>{var kr=_r(),On=Object.prototype,jn=On.hasOwnProperty;function qn(t){for(var e=t.name+"",r=kr[e],o=jn.call(kr,e)?r.length:0;o--;){var i=r[o],n=i.func;if(n==null||n==t)return i.name}return e}Tr.exports=qn});var he=h((fa,Ar)=>{var Ln=Oe(),In=ne(),Mn=4294967295;function fe(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Mn,this.__views__=[]}fe.prototype=Ln(In.prototype);fe.prototype.constructor=fe;Ar.exports=fe});var jr=h((ha,Or)=>{function Rn(t,e){var r=-1,o=t.length;for(e||(e=Array(o));++r<o;)e[r]=t[r];return e}Or.exports=Rn});var Lr=h((ua,qr)=>{var Bn=he(),En=le(),Kn=jr();function Wn(t){if(t instanceof Bn)return t.clone();var e=new En(t.__wrapped__,t.__chain__);return e.__actions__=Kn(t.__actions__),e.__index__=t.__index__,e.__values__=t.__values__,e}qr.exports=Wn});var Rr=h((ma,Mr)=>{var zn=he(),Ir=le(),Gn=ne(),$n=pe(),Hn=ce(),Un=Lr(),Yn=Object.prototype,Jn=Yn.hasOwnProperty;function ue(t){if(Hn(t)&&!$n(t)&&!(t instanceof zn)){if(t instanceof Ir)return t;if(Jn.call(t,"__wrapped__"))return Un(t)}return new Ir(t)}ue.prototype=Gn.prototype;ue.prototype.constructor=ue;Mr.exports=ue});var Er=h((ga,Br)=>{var Xn=he(),Vn=Ie(),Qn=Me(),Zn=Rr();function es(t){var e=Qn(t),r=Zn[e];if(typeof r!="function"||!(e in Xn.prototype))return!1;if(t===r)return!0;var o=Vn(r);return!!o&&t===o[0]}Br.exports=es});var Gr=h((Fa,zr)=>{var Kr=le(),ts=Fr(),rs=Ie(),Re=Me(),os=pe(),Wr=Er(),is="Expected a function",ns=8,ss=32,ls=128,as=256;function ds(t){return ts(function(e){var r=e.length,o=r,i=Kr.prototype.thru;for(t&&e.reverse();o--;){var n=e[o];if(typeof n!="function")throw new TypeError(is);if(i&&!l&&Re(n)=="wrapper")var l=new Kr([],!0)}for(o=l?o:r;++o<r;){n=e[o];var s=Re(n),f=s=="wrapper"?rs(n):void 0;f&&Wr(f[0])&&f[1]==(ls|ns|ss|as)&&!f[4].length&&f[9]==1?l=l[Re(f[0])].apply(l,f[3]):l=n.length==1&&Wr(n)?l[s]():l.thru(n)}return function(){var p=arguments,c=p[0];if(l&&p.length==1&&os(c))return l.plant(c).value();for(var T=0,k=r?e[T].apply(this,p):c;++T<r;)k=e[T].call(this,k);return k}})}zr.exports=ds});var X=h((ba,$r)=>{var cs=Gr(),ps=cs();$r.exports=ps});import a from"prop-types";import g,{Component as Vs}from"react";import{DndProvider as Qs}from"react-dnd";import{HTML5Backend as Zs}from"react-dnd-html5-backend";var Je={};B(Je,{DefaultDetail:()=>te});import G from"prop-types";import E from"react";var xe=class extends E.Component{constructor(){super(...arguments);d(this,"handleCloseClick",e=>{e&&e.preventDefault(),this.props.close()})}render(){let e=this.props.file.key.split("/");return e=e.length?e[e.length-1]:"",E.createElement("div",null,E.createElement("h2",null,"Item Detail"),E.createElement("dl",null,E.createElement("dt",null,"Key"),E.createElement("dd",null,this.props.file.key),E.createElement("dt",null,"Name"),E.createElement("dd",null,e)),E.createElement("a",{href:"#",onClick:this.handleCloseClick},"Close"))}};d(xe,"propTypes",{file:G.shape({key:G.string.isRequired,name:G.string.isRequired,extension:G.string.isRequired,url:G.string}).isRequired,close:G.func});var te=xe;var Qe={};B(Qe,{DefaultFilter:()=>re});import Xe from"prop-types";import Ve from"react";var _e=class extends Ve.Component{constructor(){super(...arguments);d(this,"handleFilterChange",e=>{let r=e.target.value;this.props.updateFilter(r)})}render(){return Ve.createElement("input",{type:"search",placeholder:"Filter files",value:this.props.value,onChange:this.handleFilterChange})}};d(_e,"propTypes",{value:Xe.string.isRequired,updateFilter:Xe.func});var re=_e;var et={};B(et,{TableHeader:()=>oe});import K from"prop-types";import Y from"react";import Io from"classnames";import{DropTarget as Mo}from"react-dnd";import{NativeTypes as Ro}from"react-dnd-html5-backend";import N from"prop-types";import Ao from"react";var Ze={};B(Ze,{isFolder:()=>q,moveFilesAndFolders:()=>H});function q(t){return t.key.endsWith("/")}function H(t,e,r){if(!e.didDrop())return;let o=e.getDropResult(),i=[],n=[];t.browserProps.selection.forEach(l=>{l[l.length-1]==="/"?i.push(l):n.push(l)}),t.browserProps.openFolder(o.path),i.forEach(l=>{let s=l,f=s.split("/"),p=f[f.length-2],c=`${o.path}${p}/`;c.substr(0,s.length)!==s&&c!==s&&t.browserProps.moveFolder&&t.browserProps.moveFolder(s,c)}),n.forEach(l=>{let s=l,f=s.split("/"),p=f[f.length-1],c=`${o.path}${p}`;c!==s&&t.browserProps.moveFile&&t.browserProps.moveFile(s,c)})}var To={Archive:["zip","rar","7z"],Audio:["mp3","ogg","wav","aac"],Excel:["xls","xlsx"],Image:["jpg","jpeg","png","bmp"],PDF:["pdf"],PowerPoint:["ppt","pptx"],Text:["txt"],Video:["mp4","flv","avi","wmv","mov"],Word:["doc","docx"],Code:["js"]},ke={};for(let[t,e]of Object.entries(To))for(let r of e)ke[r]=t;var Te=class extends Ao.Component{constructor(){super(...arguments);d(this,"state",{newName:this.getName()});d(this,"handleFileClick",e=>{e&&e.preventDefault(),this.props.browserProps.preview({url:this.props.url,name:this.getName(),key:this.props.fileKey,extension:this.getExtension()})});d(this,"handleItemClick",e=>{e.stopPropagation(),this.props.browserProps.select(this.props.fileKey,"file",e.ctrlKey||e.metaKey,e.shiftKey)});d(this,"handleItemDoubleClick",e=>{e.stopPropagation(),this.handleFileClick()});d(this,"handleRenameClick",e=>{!this.props.browserProps.renameFile||this.props.browserProps.beginAction("rename",this.props.fileKey)});d(this,"handleNewNameChange",e=>{let r=e.target.value;this.setState({newName:r})});d(this,"handleRenameSubmit",e=>{if(e&&e.preventDefault(),!this.props.browserProps.renameFile)return;let r=this.state.newName.trim();if(r.length===0||["/","\\"].some(l=>r.indexOf(l)!==-1))return;let i=r,n=this.props.fileKey.lastIndexOf("/");n!==-1&&(i=`${this.props.fileKey.substr(0,n)}/${r}`),this.props.browserProps.renameFile(this.props.fileKey,i)});d(this,"handleDeleteClick",e=>{!this.props.browserProps.deleteFile||this.props.browserProps.beginAction("delete",this.props.fileKey)});d(this,"handleDeleteSubmit",e=>{e.preventDefault(),!!this.props.browserProps.deleteFile&&this.props.browserProps.deleteFile(this.props.browserProps.actionTargets)});d(this,"handleCancelEdit",e=>{this.props.browserProps.endAction()})}selectFileNameFromRef(e){if(e){let r=e.value,o=r.lastIndexOf(".");e.setSelectionRange(0,o||r.length),e.focus()}}getName(){let e=this.props.newKey||this.props.fileKey,r=e.lastIndexOf("/");return r!==-1&&(e=e.substr(r+1)),e}getExtension(){let e=this.props.fileKey.split(".");return e[e.length-1].toLowerCase().trim()}getFileType(){return ke[this.getExtension()]||"File"}connectDND(e){let r=this.props.isDragging||this.props.action;return typeof this.props.browserProps.moveFile=="function"&&!r&&!this.props.isRenaming&&(e=this.props.connectDragSource(e)),(typeof this.props.browserProps.createFiles=="function"||typeof this.props.browserProps.moveFile=="function"||typeof this.props.browserProps.moveFolder=="function")&&(e=this.props.connectDropTarget(e)),e}};d(Te,"propTypes",{fileKey:N.string,url:N.string,newKey:N.string,isRenaming:N.bool,connectDragSource:N.func,connectDropTarget:N.func,isDragging:N.bool,action:N.string,browserProps:N.shape({icons:N.object,select:N.func,beginAction:N.func,endAction:N.func,preview:N.func,createFiles:N.func,moveFile:N.func,moveFolder:N.func,renameFile:N.func,deleteFile:N.func})});var Oo={beginDrag(t){return(!t.browserProps.selection.length||!t.browserProps.selection.includes(t.fileKey))&&t.browserProps.select(t.fileKey,"file"),{key:t.fileKey}},endDrag(t,e,r){H(t,e,r)}};function jo(t,e){return{connectDragPreview:t.dragPreview(),connectDragSource:t.dragSource(),isDragging:e.isDragging()}}var qo={drop(t,e){if(e.didDrop())return;let r=t.newKey||t.fileKey,o=r.lastIndexOf("/"),i=o!==-1?r.substr(0,o+1):"",n=e.getItem();return n.files&&t.browserProps.createFiles&&t.browserProps.createFiles(n.files,i),{path:i}}};function Lo(t,e){return{connectDropTarget:t.dropTarget(),isOver:e.isOver({shallow:!0})}}var y={dragSource:Oo,dragCollect:jo,targetSource:qo,targetCollect:Lo},U=Te;var Ae=class extends Y.Component{handleHeaderClick(e){this.props.select(this.props.fileKey)}render(){let e=Y.createElement("tr",{className:Io("folder",{dragover:this.props.isOver,selected:this.props.isSelected})},Y.createElement("th",null,"File"),Y.createElement("th",{className:"size"},"Size"),Y.createElement("th",{className:"modified"},"Last Modified"));return typeof this.props.browserProps.createFiles=="function"||typeof this.props.browserProps.moveFile=="function"||typeof this.props.browserProps.moveFolder=="function"?this.props.connectDropTarget(e):e}};d(Ae,"propTypes",{select:K.func,fileKey:K.string,connectDropTarget:K.func,isOver:K.bool,isSelected:K.func,browserProps:K.shape({createFiles:K.func,moveFolder:K.func,moveFile:K.func})});var Bo=Mo(["file","folder",Ro.FILE],y.targetSource,y.targetCollect)(Ae),oe=Bo;var Vr={};B(Vr,{ListThumbnailFile:()=>ge,RawListThumbnailFile:()=>V,RawTableFile:()=>Fe,SimpleListThumbnailFile:()=>Jr,TableFile:()=>be});var Hr=ee(X());import L from"react";import hs from"classnames";import{DragSource as us,DropTarget as ms}from"react-dnd";import{NativeTypes as gs}from"react-dnd-html5-backend";import{formatDistanceToNow as Fs}from"date-fns";function fs(t,e){if(t=parseFloat(t),isNaN(t))return parseFloat("0").toFixed(e);{let r=Math.pow(10,e);return t=(Math.round(t*r)/r).toFixed(e),t.toString()}}function me(t){if(t>1024){let e=t/1024;if(e>1024){let r=e/1024;return`${fs(r,2)} MB`}return`${Math.round(e)} kB`}return`${t} B`}var V=class extends U{render(){let{thumbnail_url:e,action:r,url:o,isDragging:i,isRenaming:n,isSelected:l,isSelectable:s,isOver:f,isDeleting:p,showName:c,showSize:T,showModified:k,browserProps:D,connectDragPreview:j}=this.props,A;e?A=L.createElement("div",{className:"image",style:{backgroundImage:"url("+e+")"}}):A=D.icons[this.getFileType()]||D.icons.File;let C=i||r,_=D.confirmDeletionRenderer,w;c&&(!C&&p&&D.selection.length===1?w=L.createElement(_,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:o},this.getName()):!C&&n?w=L.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},L.createElement("input",{ref:this.selectFileNameFromRef,type:"text",value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0})):w=L.createElement("a",{href:o,download:"download",onClick:this.handleFileClick},this.getName()));let F;T&&!n&&!p&&(F=L.createElement("span",{className:"size"},L.createElement("small",null,me(this.props.size))));let M;k&&!n&&!p&&(M=L.createElement("span",{className:"modified"},"Last modified: ",Fs(this.props.modified,{addSuffix:!0})));let S={};s&&(S={onClick:this.handleItemClick});let W=L.createElement("li",u({className:hs("file",{pending:r,dragging:i,dragover:f,selected:l}),onDoubleClick:this.handleItemDoubleClick},S),L.createElement("div",{className:"item"},L.createElement("span",{className:"thumb"},A),L.createElement("span",{className:"name"},w),F,M));return typeof D.moveFile=="function"&&(W=j(W)),this.connectDND(W)}};d(V,"defaultProps",{showName:!0,showSize:!0,showModified:!0,isSelectable:!0});var bs=(0,Hr.default)(us("file",y.dragSource,y.dragCollect),ms(["file","folder",gs.FILE],y.targetSource,y.targetCollect))(V),ge=bs;import Ur from"react";var Yr=class extends Ur.Component{render(){return Ur.createElement(ge,v(u({},this.props),{showName:!1,showSize:!1,showModified:!1,isSelectable:!1}))}},Jr=Yr;var Xr=ee(X());import R from"react";import ws from"classnames";import{DragSource as vs,DropTarget as ys}from"react-dnd";import{NativeTypes as Ds}from"react-dnd-html5-backend";import{formatDistanceToNow as Cs}from"date-fns";var Fe=class extends U{render(){let{isDragging:e,isDeleting:r,isRenaming:o,isOver:i,isSelected:n,action:l,url:s,browserProps:f,connectDragPreview:p,depth:c,size:T,modified:k}=this.props,D=f.icons[this.getFileType()]||f.icons.File,j=e||l,A=f.confirmDeletionRenderer,C;!j&&r&&f.selection.length===1?C=R.createElement(A,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:s},D,this.getName()):!j&&o?C=R.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},D,R.createElement("input",{ref:this.selectFileNameFromRef,type:"text",value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0})):C=R.createElement("a",{href:s||"#",download:"download",onClick:this.handleFileClick},D,this.getName());let _=R.createElement("div",null,C);typeof f.moveFile=="function"&&(_=p(_));let w=R.createElement("tr",{className:ws("file",{pending:l,dragging:e,dragover:i,selected:n}),onClick:this.handleItemClick,onDoubleClick:this.handleItemDoubleClick},R.createElement("td",{className:"name"},R.createElement("div",{style:{paddingLeft:c*16+"px"}},_)),R.createElement("td",{className:"size"},me(T)),R.createElement("td",{className:"modified"},typeof k=="undefined"?"-":Cs(k,{addSuffix:!0})));return this.connectDND(w)}},Ss=(0,Xr.default)(vs("file",y.dragSource,y.dragCollect),ys(["file","folder",Ds.FILE],y.targetSource,y.targetCollect))(Fe),be=Ss;var to={};B(to,{ListThumbnailFolder:()=>Zr,RawListThumbnailFolder:()=>we,RawTableFolder:()=>ve,TableFolder:()=>ye});var Qr=ee(X());import O from"react";import _s from"classnames";import{DragSource as ks,DropTarget as Ts}from"react-dnd";import{NativeTypes as As}from"react-dnd-html5-backend";import b from"prop-types";import Ns from"react";var Be=class extends Ns.Component{constructor(){super(...arguments);d(this,"state",{newName:this.props.isDraft?"New folder":this.getName()});d(this,"handleFolderClick",e=>{e.stopPropagation(),this.props.browserProps.select(this.props.fileKey,"folder",e.ctrlKey||e.metaKey,e.shiftKey)});d(this,"handleFolderDoubleClick",e=>{e.stopPropagation(),this.toggleFolder()});d(this,"handleRenameClick",e=>{!this.props.browserProps.renameFolder||this.props.browserProps.beginAction("rename",this.props.fileKey)});d(this,"handleNewNameChange",e=>{let r=e.target.value;this.setState({newName:r})});d(this,"handleRenameSubmit",e=>{if(e.preventDefault(),!this.props.browserProps.renameFolder&&!this.props.isDraft)return;let r=this.state.newName.trim();if(r.length===0||["/","\\"].some(n=>r.indexOf(n)!==-1))return;let i=this.props.fileKey.substr(0,this.props.fileKey.substr(0,this.props.fileKey.length-1).lastIndexOf("/"));i.length&&(i+="/"),i+=r,i+="/",this.props.isDraft?this.props.browserProps.createFolder(i):this.props.browserProps.renameFolder(this.props.fileKey,i)});d(this,"handleDeleteClick",e=>{!this.props.browserProps.deleteFolder||this.props.browserProps.beginAction("delete",this.props.fileKey)});d(this,"handleDeleteSubmit",e=>{e.preventDefault(),!!this.props.browserProps.deleteFolder&&this.props.browserProps.deleteFolder(this.props.browserProps.actionTargets)});d(this,"handleCancelEdit",e=>{this.props.browserProps.endAction()});d(this,"toggleFolder",()=>{this.props.browserProps.toggleFolder(this.props.fileKey)})}selectFolderNameFromRef(e){if(e){let r=e.value;e.setSelectionRange(0,r.length),e.focus()}}getName(){if(this.props.name)return this.props.name;let e=this.props.fileKey.split("/");return this.props.newName||e[e.length-2]}connectDND(e){let r=this.props.isDragging||this.props.action;return this.props.keyDerived&&(typeof this.props.browserProps.moveFolder=="function"&&!r&&!this.props.isRenaming&&!this.props.isDeleting&&(e=this.props.connectDragSource(e)),(typeof this.props.browserProps.createFiles=="function"||typeof this.props.browserProps.moveFolder=="function"||typeof this.props.browserProps.moveFile=="function")&&(e=this.props.connectDropTarget(e))),e}};d(Be,"propTypes",{name:b.string,fileKey:b.string,newName:b.string,keyDerived:b.bool,isDraft:b.bool,isRenaming:b.bool,isDeleting:b.bool,connectDragSource:b.func,connectDropTarget:b.func,isDragging:b.bool,action:b.string,browserProps:b.shape({select:b.func,toggleFolder:b.func,beginAction:b.func,endAction:b.func,preview:b.func,createFiles:b.func,createFolder:b.func,moveFile:b.func,moveFolder:b.func,renameFolder:b.func,deleteFolder:b.func})});var Ps={beginDrag(t){return t.browserProps.selection.length||t.browserProps.select(t.fileKey,"folder"),{key:t.fileKey}},endDrag(t,e,r){H(t,e,r)}};function xs(t,e){return{connectDragPreview:t.dragPreview(),connectDragSource:t.dragSource(),isDragging:e.isDragging()}}var z={dragSource:Ps,dragCollect:xs},Q=Be;var we=class extends Q{render(){let{isOpen:e,isDragging:r,isDeleting:o,isRenaming:i,isDraft:n,isOver:l,isSelected:s,url:f,action:p,browserProps:c,depth:T,keyDerived:k,connectDragPreview:D}=this.props,j=c.icons[e?"FolderOpen":"Folder"],A=r||p,C=c.confirmDeletionRenderer,_;!A&&o&&c.selection.length===1?_=O.createElement(C,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:f},this.getName()):!A&&i||n?_=O.createElement("div",null,O.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},O.createElement("input",{type:"text",ref:this.selectFolderNameFromRef,value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0}))):_=O.createElement("div",null,O.createElement("a",{onClick:this.toggleFolder},this.getName()));let w;if(e&&c.nestChildren){w=[];for(let M=0;M<w.length;M++){let S=w[M],W=v(u({},c.getItemProps(S,c)),{depth:T+1});q(S)?w.push(O.createElement(c.folderRenderer,u(v(u(u({},S),W),{browserProps:c}),c.folderRendererProps))):w.push(O.createElement(c.fileRenderer,u(v(u(u({},S),W),{browserProps:c}),c.fileRendererProps)))}w.length?w=O.createElement("ul",{style:{padding:"0 8px",paddingLeft:"16px"}},w):w=O.createElement("p",null,"No items in this folder")}let F=O.createElement("li",{className:_s("folder",{expanded:e&&c.nestChildren,pending:p,dragging:r,dragover:l,selected:s}),onClick:this.handleFolderClick,onDoubleClick:this.handleFolderDoubleClick},O.createElement("div",{className:"item"},O.createElement("span",{className:"thumb"},j),O.createElement("span",{className:"name"},_)),w);return typeof c.moveFolder=="function"&&k&&(F=D(F)),this.connectDND(F)}},Os=(0,Qr.default)(ks("folder",z.dragSource,z.dragCollect),Ts(["file","folder",As.FILE],y.targetSource,y.targetCollect))(we),Zr=Os;var eo=ee(X());import I from"react";import js from"classnames";import{DragSource as qs,DropTarget as Ls}from"react-dnd";import{NativeTypes as Is}from"react-dnd-html5-backend";var ve=class extends Q{render(){let{isOpen:e,isDragging:r,isDeleting:o,isRenaming:i,isDraft:n,isOver:l,isSelected:s,action:f,url:p,browserProps:c,connectDragPreview:T,depth:k}=this.props,D=c.icons[e?"FolderOpen":"Folder"],j=r||f,A=c.confirmDeletionRenderer,C;!j&&o&&c.selection.length===1?C=I.createElement(A,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:p},D,this.getName()):!j&&i||n?C=I.createElement("div",null,I.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},D,I.createElement("input",{type:"text",ref:this.selectFolderNameFromRef,value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0}))):C=I.createElement("div",null,I.createElement("a",{onClick:this.toggleFolder},D,this.getName()));let _=I.createElement("div",null,C);typeof c.moveFile=="function"&&(_=T(_));let w=I.createElement("tr",{className:js("folder",{pending:f,dragging:r,dragover:l,selected:s}),onClick:this.handleFolderClick,onDoubleClick:this.handleFolderDoubleClick},I.createElement("td",{className:"name"},I.createElement("div",{style:{paddingLeft:k*16+"px"}},_)),I.createElement("td",null),I.createElement("td",null));return this.connectDND(w)}},Ms=(0,eo.default)(qs("folder",z.dragSource,z.dragCollect),Ls(["file","folder",Is.FILE],y.targetSource,y.targetCollect))(ve),ye=Ms;import De from"react";import Ce from"prop-types";var Ee=t=>{let{children:e,handleDeleteSubmit:r,handleFileClick:o,url:i}=t;return De.createElement("form",{className:"deleting",onSubmit:r},De.createElement("a",{href:i,download:"download",onClick:o},e),De.createElement("div",null,De.createElement("button",{type:"submit"},"Confirm Deletion")))};Ee.propTypes={children:Ce.node,handleDeleteSubmit:Ce.func,handleFileClick:Ce.func,url:Ce.string};Ee.defaultProps={url:"#"};var Ke=Ee;import Rs from"react";import Bs from"prop-types";var ro=t=>{let{handleDeleteSubmit:e}=t;return Rs.createElement("button",{className:"deleting",onClick:e},"Confirm Deletion")};ro.propTypes={handleDeleteSubmit:Bs.func};var We=ro;var co={};B(co,{GroupByFolder:()=>Se,GroupByModifiedRelative:()=>ao});function Se(t,e){let r={contents:[],children:{}};t.map(i=>{i.relativeKey=(i.newKey||i.key).substr(e.length);let n=r,l=i.relativeKey.split("/");l.map((s,f)=>{if(f===l.length-1&&q(i))for(let c in i)n[c]=i[c];if(s==="")return;!q(i)&&f===l.length-1?n.contents.push(v(u({},i),{keyDerived:!0})):(s in n.children||(n.children[s]={contents:[],children:{}}),n=n.children[s])})});function o(i,n){n!==""&&(n+="/");let l=[];for(let s in i.children)l.push(v(u({},i.children[s]),{contents:void 0,keyDerived:!0,key:e+n+s+"/",relativeKey:n+s+"/",children:o(i.children[s],n+s),size:0}));return l=l.concat(i.contents),l}return t=o(r,""),t}import{format as Hs,startOfMonth as Us,endOfMonth as Ys}from"date-fns";import{startOfToday as Es,endOfToday as Ks,startOfYesterday as Ws,endOfYesterday as zs,startOfWeek as oo,endOfWeek as io,addWeeks as no,startOfMonth as Gs,endOfMonth as $s,getMonth as so}from"date-fns";function lo(){let t=[],e=new Date;return t.push({name:"Today",begins:Es(),ends:Ks(),items:[]}),t.push({name:"Yesterday",begins:Ws(),ends:zs(),items:[]}),t.push({name:"Earlier this Week",begins:oo(e),ends:io(e),items:[]}),t.push({name:"Last Week",begins:oo(no(e,-1)),ends:io(no(e,-1)),items:[]}),so(t[t.length-1].begins)===so(e)&&t.push({name:"Earlier this Month",begins:Gs(e),ends:$s(e),items:[]}),t}function ao(t,e){let r=lo();for(let i=0;i<t.length;i++){let n=t[i];if(q(n))continue;let l=v(u({},n),{keyDerived:!0}),s=!1,f=+l.modified;for(let p=0;p<r.length;p++){let c=r[p];if(f>+c.begins&&f<=+c.ends){c.items.push(l),s=!0;break}}if(!s){let p={name:Hs(l.modified,"MMMM yyyy"),begins:Us(l.modified),ends:Ys(l.modified),items:[]};p.items.push(l),r.push(p)}}let o=[];for(let i=0;i<r.length;i++){let n=r[i];!n.items.length||o.push({key:`${n.name.toLowerCase().replace(" ","_")}/`,name:n.name,children:n.items,size:0})}return o}var mo={};B(mo,{SortByModified:()=>uo,SortByName:()=>Ne});var po=/(-?\d*\.?\d+)/g;function ze(t,e){let r=String(t.name).split(po),o=String(e.name).split(po),i=Math.min(r.length,o.length);for(let n=0;n<i;n++){let l=parseFloat(r[n])||r[n].toLowerCase(),s=parseFloat(o[n])||o[n].toLowerCase();if(l<s)return-1;if(l>s)return 1}return 0}function Js(t,e){return t.draft&&!e.draft?1:e.draft&&!t.draft?-1:ze(t,e)}function fo(t){let e=[],r=[];for(let i=0;i<t.length;i++){let n=t[i],l=(n.newKey||n.key).split("/");n.children?(n.name||(n.name=l[l.length-2]),e.push(n)):(n.name||(n.name=l[l.length-1]),r.push(n))}r=r.sort(ze),e=e.sort(Js);for(let i=0;i<e.length;i++){let n=e[i];n.children=fo(n.children)}let o=[];return o=o.concat(e),o=o.concat(r),o}function Ne(t){return fo(t)}import{compareAsc as Xs}from"date-fns";function ho(t){let e=[],r=[];for(let i=0;i<t.length;i++){let n=t[i],l=(n.newKey||n.key).split("/");n.children?e.push(n):(n.name=l[l.length-1],r.push(n))}r=r.sort(Xs);for(let i=0;i<e.length;i++){let n=e[i];n.children=ho(n.children)}let o=[];return o=o.concat(e),o=o.concat(r),o}function uo(t){return ho(t)}import P from"react";import x from"prop-types";var Ge=t=>{let{selectedItems:e,isFolder:r,icons:o,nameFilter:i,canCreateFolder:n,onCreateFolder:l,canRenameFile:s,onRenameFile:f,canRenameFolder:p,onRenameFolder:c,canDeleteFile:T,onDeleteFile:k,canDeleteFolder:D,onDeleteFolder:j,canDownloadFile:A,onDownloadFile:C,canDownloadFolder:_,onDownloadFolder:w}=t,F=[];if(e.length){let M=e.filter(S=>S.action);if(M.length===e.length&&[...new Set(M)].length===1){let S;switch(M[0].action){case"delete":S="Deleting ...";break;case"rename":S="Renaming ...";break;default:S="Moving ...";break}F=P.createElement("div",{className:"item-actions"},o.Loading," ",S)}else{r&&n&&!i&&F.push(P.createElement("li",{key:"action-add-folder"},P.createElement("a",{onClick:l,href:"#",role:"button"},o.Folder,"\xA0Add Subfolder")));let S=e.find(W=>!W.keyDerived);!S&&!r&&s&&e.length===1?F.push(P.createElement("li",{key:"action-rename"},P.createElement("a",{onClick:f,href:"#",role:"button"},o.Rename,"\xA0Rename"))):!S&&r&&p&&F.push(P.createElement("li",{key:"action-rename"},P.createElement("a",{onClick:c,href:"#",role:"button"},o.Rename,"\xA0Rename"))),!S&&!r&&T?F.push(P.createElement("li",{key:"action-delete"},P.createElement("a",{onClick:k,href:"#",role:"button"},o.Delete,"\xA0Delete"))):!S&&r&&D&&F.push(P.createElement("li",{key:"action-delete"},P.createElement("a",{onClick:j,href:"#",role:"button"},o.Delete,"\xA0Delete"))),(!r&&A||r&&_)&&F.push(P.createElement("li",{key:"action-download"},P.createElement("a",{onClick:r?w:C,href:"#",role:"button"},o.Download,"\xA0Download"))),F.length?F=P.createElement("ul",{className:"item-actions"},F):F=P.createElement("div",{className:"item-actions"},"\xA0")}}else n&&!i&&F.push(P.createElement("li",{key:"action-add-folder"},P.createElement("a",{onClick:l,href:"#",role:"button"},o.Folder,"\xA0Add Folder"))),F.length?F=P.createElement("ul",{className:"item-actions"},F):F=P.createElement("div",{className:"item-actions"},"\xA0");return F};Ge.propTypes={selectedItems:x.arrayOf(x.object),isFolder:x.bool,icons:x.object,nameFilter:x.string,canCreateFolder:x.bool,onCreateFolder:x.func,canRenameFile:x.bool,onRenameFile:x.func,canRenameFolder:x.bool,onRenameFolder:x.func,canDeleteFile:x.bool,onDeleteFile:x.func,canDeleteFolder:x.bool,onDeleteFolder:x.func,canDownloadFile:x.bool,onDownloadFile:x.func,canDownloadFolder:x.bool,onDownloadFolder:x.func};Ge.defaultProps={selectedItems:[],isFolder:!1,icons:{},nameFilter:"",canCreateFolder:!1,onCreateFolder:null,canRenameFile:!1,onRenameFile:null,canRenameFolder:!1,onRenameFolder:null,canDeleteFile:!1,onDeleteFile:null,canDeleteFolder:!1,onDeleteFolder:null,canDownloadFile:!1,onDownloadFile:null,canDownloadFolder:!1,onDownloadFolder:null};var $e=Ge;var He=20,el=/.*\/__new__[/]?$/gm;function tl(t,e){return{key:`file-${t.key}`,fileKey:t.key,isSelected:e.selection.includes(t.key),isOpen:t.key in e.openFolders||e.nameFilter,isRenaming:e.activeAction==="rename"&&e.actionTargets.includes(t.key),isDeleting:e.activeAction==="delete"&&e.actionTargets.includes(t.key),isDraft:!!t.draft}}var Z=class extends g.Component{constructor(){super(...arguments);d(this,"state",{openFolders:{},selection:[],activeAction:null,actionTargets:[],nameFilter:"",searchResultsShown:He,previewFile:null,addFolder:null});d(this,"getFile",e=>{let r=!1,o=this.props.files.find(i=>(i.key.startsWith(e)&&(r=!0),i.key===e));if(o)return o;if(r)return{key:e,modified:0,size:0,relativeKey:e}});d(this,"createFiles",(e,r)=>{this.setState(o=>{let i={selection:[]};return r&&(i.openFolders=v(u({},o.openFolders),{[r]:!0})),i},()=>{this.props.onCreateFiles(e,r)})});d(this,"createFolder",e=>{this.setState({activeAction:null,actionTargets:[],selection:[e]},()=>{this.props.onCreateFolder(e)})});d(this,"moveFile",(e,r)=>{this.setState({activeAction:null,actionTargets:[],selection:[r]},()=>{this.props.onMoveFile(e,r)})});d(this,"moveFolder",(e,r)=>{this.setState(o=>{let i={activeAction:null,actionTargets:[],selection:[r]};return e in o.openFolders&&(i.openFolders=v(u({},o.openFolders),{[r]:!0})),i},()=>{this.props.onMoveFolder(e,r)})});d(this,"renameFile",(e,r)=>{this.setState({activeAction:null,actionTargets:[],selection:[r]},()=>{this.props.onRenameFile(e,r)})});d(this,"renameFolder",(e,r)=>{this.setState(o=>{let i={activeAction:null,actionTargets:[]};return o.selection[0].substr(0,e.length)===e&&(i.selection=[o.selection[0].replace(e,r)]),e in o.openFolders&&(i.openFolders=v(u({},o.openFolders),{[r]:!0})),i},()=>{this.props.onRenameFolder(e,r)})});d(this,"deleteFile",e=>{this.setState({activeAction:null,actionTargets:[],selection:[]},()=>{this.props.onDeleteFile(e)})});d(this,"deleteFolder",e=>{this.setState(r=>{let o={activeAction:null,actionTargets:[],selection:[]};return e in r.openFolders&&(o.openFolders=u({},r.openFolders),delete o.openFolders[e]),o},()=>{this.props.onDeleteFolder(e)})});d(this,"downloadFile",e=>{this.setState({activeAction:null,actionTargets:[]},()=>{this.props.onDownloadFile(e)})});d(this,"downloadFolder",e=>{this.setState({activeAction:null,actionTargets:[]},()=>{this.props.onDownloadFolder(e)})});d(this,"beginAction",(e,r)=>{this.setState({activeAction:e,actionTargets:r||[]})});d(this,"endAction",()=>{this.state.selection&&this.state.selection.length>0&&this.state.selection.filter(e=>e.match(el)).length>0&&this.setState({selection:[]}),this.beginAction(null,null)});d(this,"select",(e,r,o,i)=>{let{actionTargets:n}=this.state,l=n.length&&!n.includes(e),s=this.getFile(e),f=[e];if(o||i){let p=this.state.selection.indexOf(e);p!==-1?f=[...this.state.selection.slice(0,p),...this.state.selection.slice(p+1)]:f=[...this.state.selection,e]}this.setState(p=>({selection:f,actionTargets:l?[]:n,activeAction:l?null:p.activeAction}),()=>{this.props.onSelect(s),r==="file"&&this.props.onSelectFile(s),r==="folder"&&this.props.onSelectFolder(s)})});d(this,"preview",e=>{this.state.previewFile&&this.state.previewFile.key!==e.key&&this.closeDetail(),this.setState({previewFile:e},()=>{this.props.onPreviewOpen(e)})});d(this,"closeDetail",()=>{this.setState({previewFile:null},()=>{this.props.onPreviewClose(this.state.previewFile)})});d(this,"handleShowMoreClick",e=>{e.preventDefault(),this.setState(r=>({searchResultsShown:r.searchResultsShown+He}))});d(this,"toggleFolder",e=>{let r=e in this.state.openFolders;this.setState(o=>{let i={openFolders:u({},o.openFolders)};return r?delete i.openFolders[e]:i.openFolders[e]=!0,i},()=>{let o=r?"onFolderClose":"onFolderOpen";this.props[o](this.getFile(e))})});d(this,"openFolder",e=>{this.setState(r=>({openFolders:v(u({},r.openFolders),{[e]:!0})}),()=>{this.props.onFolderOpen(this.getFile(e))})});d(this,"handleGlobalClick",e=>{!!(this.browserRef&&this.browserRef.contains(e.target))||this.setState({selection:[],actionTargets:[],activeAction:null})});d(this,"handleActionBarRenameClick",e=>{e.preventDefault(),this.beginAction("rename",this.state.selection)});d(this,"handleActionBarDeleteClick",e=>{e.preventDefault(),this.beginAction("delete",this.state.selection)});d(this,"handleActionBarAddFolderClick",e=>{e.preventDefault(),this.state.activeAction!=="createFolder"&&this.setState(r=>{let o="";r.selection&&r.selection.length>0&&(o+=r.selection,o.substr(o.length-1,o.length)!=="/"&&(o+="/")),o!=="__new__/"&&!o.endsWith("/__new__/")&&(o+="__new__/");let i={actionTargets:[o],activeAction:"createFolder",selection:[o]};return r.selection&&r.selection.length>0&&(i.openFolders=v(u({},r.openFolders),{[this.state.selection]:!0})),i})});d(this,"handleActionBarDownloadClick",e=>{e.preventDefault();let r=this.getFiles(),o=this.getSelectedItems(r);if(o.length===1&&q(o[0])){this.downloadFolder(this.state.selection);return}this.downloadFile(this.state.selection)});d(this,"updateFilter",e=>{this.setState({nameFilter:e,searchResultsShown:He})});d(this,"handleMultipleDeleteSubmit",()=>{console.log(this),this.deleteFolder(this.state.selection.filter(e=>e[e.length-1]==="/")),this.deleteFile(this.state.selection.filter(e=>e[e.length-1]!=="/"))})}componentDidMount(){this.props.renderStyle==="table"&&this.props.nestChildren&&console.warn("Invalid settings: Cannot nest table children in file browser"),window.addEventListener("click",this.handleGlobalClick)}componentWillUnmount(){window.removeEventListener("click",this.handleGlobalClick)}getBrowserProps(){return{nestChildren:this.props.nestChildren,fileRenderer:this.props.fileRenderer,fileRendererProps:this.props.fileRendererProps,folderRenderer:this.props.folderRenderer,folderRendererProps:this.props.folderRendererProps,confirmDeletionRenderer:this.props.confirmDeletionRenderer,confirmMultipleDeletionRenderer:this.props.confirmMultipleDeletionRenderer,icons:this.props.icons,openFolders:this.state.openFolders,nameFilter:this.state.nameFilter,selection:this.state.selection,activeAction:this.state.activeAction,actionTargets:this.state.actionTargets,select:this.select,openFolder:this.openFolder,toggleFolder:this.toggleFolder,beginAction:this.beginAction,endAction:this.endAction,preview:this.preview,createFiles:this.props.onCreateFiles?this.createFiles:void 0,createFolder:this.props.onCreateFolder?this.createFolder:void 0,renameFile:this.props.onRenameFile?this.renameFile:void 0,renameFolder:this.props.onRenameFolder?this.renameFolder:void 0,moveFile:this.props.onMoveFile?this.moveFile:void 0,moveFolder:this.props.onMoveFolder?this.moveFolder:void 0,deleteFile:this.props.onDeleteFile?this.deleteFile:void 0,deleteFolder:this.props.onDeleteFolder?this.deleteFolder:void 0,getItemProps:tl}}renderActionBar(e){let{icons:r,canFilter:o,filterRendererProps:i,filterRenderer:n,actionRenderer:l,onCreateFolder:s,onRenameFile:f,onRenameFolder:p,onDeleteFile:c,onDeleteFolder:T,onDownloadFile:k,onDownloadFolder:D}=this.props,j=this.getBrowserProps(),A=e.length===1&&q(e[0]),C;o&&(C=g.createElement(n,u({value:this.state.nameFilter,updateFilter:this.updateFilter},i)));let _=g.createElement(l,{browserProps:j,selectedItems:e,isFolder:A,icons:r,nameFilter:this.state.nameFilter,canCreateFolder:typeof s=="function",onCreateFolder:this.handleActionBarAddFolderClick,canRenameFile:typeof f=="function",onRenameFile:this.handleActionBarRenameClick,canRenameFolder:typeof p=="function",onRenameFolder:this.handleActionBarRenameClick,canDeleteFile:typeof c=="function",onDeleteFile:this.handleActionBarDeleteClick,canDeleteFolder:typeof T=="function",onDeleteFolder:this.handleActionBarDeleteClick,canDownloadFile:typeof k=="function",onDownloadFile:this.handleActionBarDownloadClick,canDownloadFolder:typeof D=="function",onDownloadFolder:this.handleActionBarDownloadClick});return g.createElement("div",{className:"action-bar"},C,_)}renderFiles(e,r){let{fileRenderer:o,fileRendererProps:i,folderRenderer:n,folderRendererProps:l}=this.props,s=this.getBrowserProps(),f=[];return e.map(p=>{let c=v(u({},s.getItemProps(p,s)),{depth:this.state.nameFilter?0:r});q(p)?((this.props.showFoldersOnFilter||!this.state.nameFilter)&&f.push(g.createElement(n,u(v(u(u({},p),c),{browserProps:s}),l))),(this.state.nameFilter||c.isOpen&&!s.nestChildren)&&(f=f.concat(this.renderFiles(p.children,r+1)))):f.push(g.createElement(o,u(v(u(u({},p),c),{browserProps:s}),i)))}),f}getFiles(){let e=this.props.files.concat([]);if(this.state.activeAction==="createFolder"&&e.push({key:this.state.actionTargets[0],size:0,draft:!0}),this.state.nameFilter){let r=[],o=this.state.nameFilter.toLowerCase().split(" ");e.map(i=>{let n=!1;o.map(l=>{i.key.toLowerCase().trim().indexOf(l)===-1&&(n=!0)}),!n&&r.push(i)}),e=r}if(typeof this.props.group=="function")e=this.props.group(e,"");else{let r=[];e.map(o=>{q(o)||r.push(o)}),e=r}return typeof this.props.sort=="function"&&(e=this.props.sort(e)),e}getSelectedItems(e){let{selection:r}=this.state,o=[],i=n=>{r.includes(n.key)&&o.push(n),n.children&&n.children.map(i)};return e.map(i),o}render(){console.log("[render] file browser running from a local package!");let r={browserProps:this.getBrowserProps(),fileKey:"",fileCount:this.props.files.length},o,i=this.getFiles(),n=this.getSelectedItems(i),l,s=this.renderFiles(i,0);switch(this.props.renderStyle){case"table":if(!s.length)this.state.nameFilter?s=g.createElement("tr",null,g.createElement("td",{colSpan:100},'No files matching "',this.state.nameFilter,'".')):s=g.createElement("tr",null,g.createElement("td",{colSpan:100},this.props.noFilesMessage));else if(this.state.nameFilter){let p=s.length;s=s.slice(0,this.state.searchResultsShown),p>s.length&&s.push(g.createElement("tr",{key:"show-more"},g.createElement("td",{colSpan:100},g.createElement("a",{onClick:this.handleShowMoreClick,href:"#"},"Show more results"))))}this.props.headerRenderer&&(l=g.createElement("thead",null,g.createElement(this.props.headerRenderer,u(u({},r),this.props.headerRendererProps)))),o=g.createElement("table",{cellSpacing:"0",cellPadding:"0"},l,g.createElement("tbody",null,s));break;case"list":if(!s.length)this.state.nameFilter?s=g.createElement("p",{className:"empty"},'No files matching "',this.state.nameFilter,'"'):s=g.createElement("p",{className:"empty"},"No files.");else{let p;if(this.state.nameFilter){let c=s.length;s=s.slice(0,this.state.searchResultsShown),c>s.length&&(p=g.createElement("a",{onClick:this.handleShowMoreClick,href:"#"},"Show more results"))}s=g.createElement("div",null,g.createElement("ul",null,s),p)}this.props.headerRenderer&&(l=g.createElement(this.props.headerRenderer,u(u({},r),this.props.headerRendererProps))),o=g.createElement("div",null,l,s);break}let f=this.props.confirmMultipleDeletionRenderer;return g.createElement("div",{className:"rendered-react-keyed-file-browser"},this.props.actions,g.createElement("div",{className:"rendered-file-browser",ref:p=>{this.browserRef=p}},this.props.showActionBar&&this.renderActionBar(n),this.state.activeAction==="delete"&&this.state.selection.length>1&&g.createElement(f,{handleDeleteSubmit:this.handleMultipleDeleteSubmit}),g.createElement("div",{className:"files"},o)),this.state.previewFile!==null&&g.createElement(this.props.detailRenderer,u({file:this.state.previewFile,close:this.closeDetail},this.props.detailRendererProps)))}};d(Z,"propTypes",{files:a.arrayOf(a.shape({key:a.string.isRequired,modified:a.number,size:a.number})).isRequired,actions:a.node,showActionBar:a.bool.isRequired,canFilter:a.bool.isRequired,showFoldersOnFilter:a.bool,noFilesMessage:a.string,group:a.func.isRequired,sort:a.func.isRequired,icons:a.shape({Folder:a.element,FolderOpen:a.element,File:a.element,PDF:a.element,Image:a.element,Delete:a.element,Rename:a.element,Loading:a.element,Download:a.element}),nestChildren:a.bool.isRequired,renderStyle:a.oneOf(["list","table"]).isRequired,startOpen:a.bool.isRequired,headerRenderer:a.func,headerRendererProps:a.object,filterRenderer:a.func,filterRendererProps:a.object,fileRenderer:a.func,fileRendererProps:a.object,folderRenderer:a.func,folderRendererProps:a.object,detailRenderer:a.func,detailRendererProps:a.object,actionRenderer:a.func,confirmDeletionRenderer:a.func,confirmMultipleDeletionRenderer:a.func,onCreateFiles:a.oneOfType([a.func,a.bool]),onCreateFolder:a.oneOfType([a.func,a.bool]),onMoveFile:a.oneOfType([a.func,a.bool]),onMoveFolder:a.oneOfType([a.func,a.bool]),onRenameFile:a.oneOfType([a.func,a.bool]),onRenameFolder:a.oneOfType([a.func,a.bool]),onDeleteFile:a.oneOfType([a.func,a.bool]),onDeleteFolder:a.oneOfType([a.func,a.bool]),onDownloadFile:a.oneOfType([a.func,a.bool]),onDownloadFolder:a.oneOfType([a.func,a.bool]),onSelect:a.func,onSelectFile:a.func,onSelectFolder:a.func,onPreviewOpen:a.func,onPreviewClose:a.func,onFolderOpen:a.func,onFolderClose:a.func}),d(Z,"defaultProps",{showActionBar:!0,canFilter:!0,showFoldersOnFilter:!1,noFilesMessage:"No files.",group:Se,sort:Ne,nestChildren:!1,renderStyle:"table",startOpen:!1,headerRenderer:oe,headerRendererProps:{},filterRenderer:re,filterRendererProps:{},fileRenderer:be,fileRendererProps:{},folderRenderer:ye,folderRendererProps:{},detailRenderer:te,detailRendererProps:{},actionRenderer:$e,confirmDeletionRenderer:Ke,confirmMultipleDeletionRenderer:We,icons:{},onSelect:e=>{},onSelectFile:e=>{},onSelectFolder:e=>{},onPreviewOpen:e=>{},onPreviewClose:e=>{},onFolderOpen:e=>{},onFolderClose:e=>{}});var go=class extends Vs{render(){return g.createElement(Qs,{backend:Zs},g.createElement(Z,u({},this.props)))}},Fo=go;var vo={};B(vo,{FontAwesome:()=>wo});import m from"react";var bo=t=>{let e=t===4?"fa":"fas",r=t===4?["FontAwesome",'"FontAwesome"']:['"Font Awesome 5 Free"','"Font Awesome 5 Pro"'],o=!1,i=document.createElement("span");i.className=e,i.style.display="none",document.body.insertBefore(i,document.body.firstChild);let n=(l,s)=>window.getComputedStyle(l,null).getPropertyValue(s);return r.includes(n(i,"font-family"))?o=!0:console.warn(`Font Awesome ${t} was not detected but Font Awesome ${t} icons have been requested for \`react-object-list\``),document.body.removeChild(i),o},rl=(t=4)=>{switch(t){case 4:return bo(4),{File:m.createElement("i",{className:"fa fa-file-o","aria-hidden":"true"}),Image:m.createElement("i",{className:"fa fa-file-image-o","aria-hidden":"true"}),Video:m.createElement("i",{className:"fa fa-file-video-o","aria-hidden":"true"}),Audio:m.createElement("i",{className:"fa fa-file-audio-o","aria-hidden":"true"}),Archive:m.createElement("i",{className:"fa fa-file-archive-o","aria-hidden":"true"}),Word:m.createElement("i",{className:"fa fa-file-word-o","aria-hidden":"true"}),Excel:m.createElement("i",{className:"fa fa-file-excel-o","aria-hidden":"true"}),PowerPoint:m.createElement("i",{className:"fa fa-file-powerpoint-o","aria-hidden":"true"}),Text:m.createElement("i",{className:"fa fa-file-text-o","aria-hidden":"true"}),PDF:m.createElement("i",{className:"fa fa-file-pdf-o","aria-hidden":"true"}),Rename:m.createElement("i",{className:"fa fa-i-cursor","aria-hidden":"true"}),Folder:m.createElement("i",{className:"fa fa-folder-o","aria-hidden":"true"}),FolderOpen:m.createElement("i",{className:"fa fa-folder-open-o","aria-hidden":"true"}),Delete:m.createElement("i",{className:"fa fa-trash-o","aria-hidden":"true"}),Loading:m.createElement("i",{className:"fa fa-circle-o-notch fa-spin","aria-hidden":"true"}),Download:m.createElement("i",{className:"fa fa-download","aria-hidden":"true"})};case 5:return bo(5),{File:m.createElement("i",{className:"far fa-file","aria-hidden":"true"}),Image:m.createElement("i",{className:"far fa-file-image","aria-hidden":"true"}),Video:m.createElement("i",{className:"far fa-file-video","aria-hidden":"true"}),Audio:m.createElement("i",{className:"far fa-file-audio","aria-hidden":"true"}),Archive:m.createElement("i",{className:"far fa-file-archive","aria-hidden":"true"}),Word:m.createElement("i",{className:"far fa-file-word","aria-hidden":"true"}),Excel:m.createElement("i",{className:"far fa-file-excel","aria-hidden":"true"}),PowerPoint:m.createElement("i",{className:"far fa-file-powerpoint","aria-hidden":"true"}),Text:m.createElement("i",{className:"far fa-file-alt","aria-hidden":"true"}),PDF:m.createElement("i",{className:"far fa-file-pdf","aria-hidden":"true"}),Rename:m.createElement("i",{className:"fas fa-i-cursor","aria-hidden":"true"}),Folder:m.createElement("i",{className:"far fa-folder","aria-hidden":"true"}),FolderOpen:m.createElement("i",{className:"far fa-folder-open","aria-hidden":"true"}),Delete:m.createElement("i",{className:"far fa-trash-alt","aria-hidden":"true"}),Loading:m.createElement("i",{className:"fas fa-circle-notch fa-spin","aria-hidden":"true"}),Download:m.createElement("i",{className:"fas fa-download","aria-hidden":"true"})};default:console.warn(`Could not find config for version ${t}`,"Accepted versions are: 4, 5","Please make an issue in `react-object-list` to fix this.")}},wo=rl;var lc=Fo;export{U as BaseFile,y as BaseFileConnectors,Q as BaseFolder,z as BaseFolderConnectors,Je as Details,Vr as FileRenderers,Qe as Filters,to as FolderRenderers,co as Groupers,et as Headers,vo as Icons,Z as RawFileBrowser,mo as Sorters,Ze as Utils,lc as default};
//# sourceMappingURL=index.js.map
