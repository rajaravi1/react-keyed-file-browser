!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["react-keyed-file-browser"]=t():e["react-keyed-file-browser"]=t()}(window,(function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=7)}([function(e,t){e.exports=require("prop-types")},function(e,t){e.exports=require("react")},function(e,t){e.exports=require("date-fns")},function(e,t){e.exports=require("react-dnd")},function(e,t){e.exports=require("react-dnd-html5-backend")},function(e,t){e.exports=require("classnames")},function(e,t){e.exports=require("lodash/flow")},function(e,t,r){"use strict";r.r(t),r.d(t,"RawFileBrowser",(function(){return Et})),r.d(t,"BaseFile",(function(){return _})),r.d(t,"BaseFileConnectors",(function(){return I})),r.d(t,"BaseFolder",(function(){return we})),r.d(t,"BaseFolderConnectors",(function(){return be})),r.d(t,"Headers",(function(){return i})),r.d(t,"FileRenderers",(function(){return s})),r.d(t,"FolderRenderers",(function(){return l})),r.d(t,"Details",(function(){return n})),r.d(t,"Filters",(function(){return o})),r.d(t,"Groupers",(function(){return c})),r.d(t,"Sorters",(function(){return d})),r.d(t,"Icons",(function(){return p})),r.d(t,"Utils",(function(){return a}));var n={};r.r(n),r.d(n,"DefaultDetail",(function(){return v}));var o={};r.r(o),r.d(o,"DefaultFilter",(function(){return O})),r.d(o,"DefaultFilterLogic",(function(){return R}));var a={};r.r(a),r.d(a,"isFolder",(function(){return N})),r.d(a,"moveFilesAndFolders",(function(){return k}));var i={};r.r(i),r.d(i,"TableHeader",(function(){return W}));var s={};r.r(s),r.d(s,"ListThumbnailFile",(function(){return ee})),r.d(s,"SimpleListThumbnailFile",(function(){return ce})),r.d(s,"TableFile",(function(){return fe})),r.d(s,"RawListThumbnailFile",(function(){return Z})),r.d(s,"RawTableFile",(function(){return ue}));var l={};r.r(l),r.d(l,"ListThumbnailFolder",(function(){return ke})),r.d(l,"TableFolder",(function(){return je})),r.d(l,"RawListThumbnailFolder",(function(){return Ne})),r.d(l,"RawTableFolder",(function(){return Te}));var c={};r.r(c),r.d(c,"GroupByFolder",(function(){return He})),r.d(c,"GroupByModifiedRelative",(function(){return tt}));var d={};r.r(d),r.d(d,"SortByName",(function(){return at})),r.d(d,"SortByModified",(function(){return it}));var p={};r.r(p),r.d(p,"FontAwesome",(function(){return Rt}));var h=r(0),u=r.n(h),f=r(1),m=r.n(f),g=r(3),F=r(4),b=Object.defineProperty,w=(e,t,r)=>(((e,t,r)=>{t in e?b(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class y extends m.a.Component{constructor(){super(...arguments),w(this,"handleCloseClick",e=>{e&&e.preventDefault(),this.props.close()})}render(){let e=this.props.file.key.split("/");return e=e.length?e[e.length-1]:"",m.a.createElement("div",null,m.a.createElement("h2",null,"Item Detail"),m.a.createElement("dl",null,m.a.createElement("dt",null,"Key"),m.a.createElement("dd",null,this.props.file.key),m.a.createElement("dt",null,"Name"),m.a.createElement("dd",null,e)),m.a.createElement("a",{href:"#",onClick:this.handleCloseClick},"Close"))}}w(y,"propTypes",{file:u.a.shape({key:u.a.string.isRequired,name:u.a.string.isRequired,extension:u.a.string.isRequired,url:u.a.string}).isRequired,close:u.a.func});var v=y,D=Object.defineProperty,E=(e,t,r)=>(((e,t,r)=>{t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class P extends m.a.Component{constructor(){super(...arguments),E(this,"handleFilterChange",e=>{const t=e.target.value;this.props.updateFilter(t)})}render(){return m.a.createElement("input",{type:"search",placeholder:"Filter files",value:this.props.value,onChange:this.handleFilterChange})}}E(P,"propTypes",{value:u.a.string.isRequired,updateFilter:u.a.func});var O=P;const R=(e,t)=>{const r=[],n=e.toLowerCase().split(" ");return t.map(e=>{let t=!1;n.map(r=>{-1===e.key.toLowerCase().trim().indexOf(r)&&(t=!0)}),t||r.push(e)}),r};var C=r(5),S=r.n(C);function N(e){return e.key.endsWith("/")}function k(e,t,r){if(!t.didDrop())return;const n=t.getDropResult(),o=[],a=[];e.browserProps.selection.forEach(e=>{"/"===e[e.length-1]?o.push(e):a.push(e)}),e.browserProps.openFolder(n.path),o.forEach(t=>{const r=t,o=r.split("/"),a=o[o.length-2],i=`${n.path}${a}/`;i.substr(0,r.length)!==r&&i!==r&&e.browserProps.moveFolder&&e.browserProps.moveFolder(r,i)}),a.forEach(t=>{const r=t,o=r.split("/"),a=o[o.length-1],i=`${n.path}${a}`;i!==r&&e.browserProps.moveFile&&e.browserProps.moveFile(r,i)})}const T={Archive:["zip","rar","7z"],Audio:["mp3","ogg","wav","aac"],Excel:["xls","xlsx"],Image:["jpg","jpeg","png","bmp"],PDF:["pdf"],PowerPoint:["ppt","pptx"],Text:["txt"],Video:["mp4","flv","avi","wmv","mov"],Word:["doc","docx"],Code:["js"]},j={};for(const[e,t]of Object.entries(T))for(const r of t)j[r]=e;var A=Object.defineProperty,x=(e,t,r)=>(((e,t,r)=>{t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class M extends m.a.Component{constructor(){super(...arguments),x(this,"state",{newName:this.getName()}),x(this,"handleFileClick",e=>{e&&e.preventDefault(),this.props.browserProps.preview({url:this.props.url,name:this.getName(),key:this.props.fileKey,extension:this.getExtension()})}),x(this,"handleItemClick",e=>{e.stopPropagation(),this.props.browserProps.select(this.props.fileKey,"file",e.ctrlKey||e.metaKey,e.shiftKey)}),x(this,"handleItemDoubleClick",e=>{e.stopPropagation(),this.handleFileClick()}),x(this,"handleRenameClick",e=>{this.props.browserProps.renameFile&&this.props.browserProps.beginAction("rename",this.props.fileKey)}),x(this,"handleNewNameChange",e=>{const t=e.target.value;this.setState({newName:t})}),x(this,"handleRenameSubmit",e=>{if(e&&e.preventDefault(),!this.props.browserProps.renameFile)return;const t=this.state.newName.trim();if(0===t.length)return;if(["/","\\"].some(e=>-1!==t.indexOf(e)))return;let r=t;const n=this.props.fileKey.lastIndexOf("/");-1!==n&&(r=`${this.props.fileKey.substr(0,n)}/${t}`),this.props.browserProps.renameFile(this.props.fileKey,r)}),x(this,"handleDeleteClick",e=>{this.props.browserProps.deleteFile&&this.props.browserProps.beginAction("delete",this.props.fileKey)}),x(this,"handleDeleteSubmit",e=>{e.preventDefault(),this.props.browserProps.deleteFile&&this.props.browserProps.deleteFile(this.props.browserProps.actionTargets)}),x(this,"handleCancelEdit",e=>{this.props.browserProps.endAction()})}selectFileNameFromRef(e){if(e){const t=e.value,r=t.lastIndexOf(".");e.setSelectionRange(0,r||t.length),e.focus()}}getName(){let e=this.props.newKey||this.props.fileKey;const t=e.lastIndexOf("/");return-1!==t&&(e=e.substr(t+1)),e}getExtension(){const e=this.props.fileKey.split(".");return e[e.length-1].toLowerCase().trim()}getFileType(){return j[this.getExtension()]||"File"}connectDND(e){const t=this.props.isDragging||this.props.action;return"function"!=typeof this.props.browserProps.moveFile||t||this.props.isRenaming||(e=this.props.connectDragSource(e)),"function"!=typeof this.props.browserProps.createFiles&&"function"!=typeof this.props.browserProps.moveFile&&"function"!=typeof this.props.browserProps.moveFolder||(e=this.props.connectDropTarget(e)),e}}x(M,"propTypes",{fileKey:u.a.string,url:u.a.string,newKey:u.a.string,isRenaming:u.a.bool,connectDragSource:u.a.func,connectDropTarget:u.a.func,isDragging:u.a.bool,action:u.a.string,browserProps:u.a.shape({icons:u.a.object,select:u.a.func,beginAction:u.a.func,endAction:u.a.func,preview:u.a.func,createFiles:u.a.func,moveFile:u.a.func,moveFolder:u.a.func,renameFile:u.a.func,deleteFile:u.a.func})});const I={dragSource:{beginDrag:e=>(e.browserProps.selection.length&&e.browserProps.selection.includes(e.fileKey)||e.browserProps.select(e.fileKey,"file"),{key:e.fileKey}),endDrag(e,t,r){k(e,t)}},dragCollect:function(e,t){return{connectDragPreview:e.dragPreview(),connectDragSource:e.dragSource(),isDragging:t.isDragging()}},targetSource:{drop(e,t){if(t.didDrop())return;const r=e.newKey||e.fileKey,n=r.lastIndexOf("/"),o=-1!==n?r.substr(0,n+1):"",a=t.getItem();return a.files&&e.browserProps.createFiles&&e.browserProps.createFiles(a.files,o),{path:o}}},targetCollect:function(e,t){return{connectDropTarget:e.dropTarget(),isOver:t.isOver({shallow:!0})}}};var K,B,L,_=M,q=Object.defineProperty;class z extends m.a.Component{handleHeaderClick(e){this.props.select(this.props.fileKey)}render(){const e=m.a.createElement("tr",{className:S()("folder",{dragover:this.props.isOver,selected:this.props.isSelected})},m.a.createElement("th",null,"File"),m.a.createElement("th",{className:"size"},"Size"),m.a.createElement("th",{className:"modified"},"Last Modified"));return"function"==typeof this.props.browserProps.createFiles||"function"==typeof this.props.browserProps.moveFile||"function"==typeof this.props.browserProps.moveFolder?this.props.connectDropTarget(e):e}}K=z,B="propTypes",L={select:u.a.func,fileKey:u.a.string,connectDropTarget:u.a.func,isOver:u.a.bool,isSelected:u.a.func,browserProps:u.a.shape({createFiles:u.a.func,moveFolder:u.a.func,moveFile:u.a.func})},((e,t,r)=>{t in e?q(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(K,"symbol"!=typeof B?B+"":B,L);var W=Object(g.DropTarget)(["file","folder",F.NativeTypes.FILE],I.targetSource,I.targetCollect)(z),$=r(2),G=r(6),H=r.n(G);function V(e){if(e>1024){const t=e/1024;if(t>1024){return function(e,t){if(e=parseFloat(e),isNaN(e))return parseFloat("0").toFixed(t);{const r=Math.pow(10,t);return(e=(Math.round(e*r)/r).toFixed(t)).toString()}}(t/1024,2)+" MB"}return Math.round(t)+" kB"}return e+" B"}var Y=Object.defineProperty,U=Object.getOwnPropertySymbols,J=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable,X=(e,t,r)=>t in e?Y(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;class Z extends _{render(){const{thumbnail_url:e,action:t,url:r,isDragging:n,isRenaming:o,isSelected:a,isSelectable:i,isOver:s,isDeleting:l,showName:c,showSize:d,showModified:p,browserProps:h,connectDragPreview:u}=this.props;let f;f=e?m.a.createElement("div",{className:"image",style:{backgroundImage:"url("+e+")"}}):h.icons[this.getFileType()]||h.icons.File;const g=n||t,F=h.confirmDeletionRenderer;let b,w,y;c&&(b=!g&&l&&1===h.selection.length?m.a.createElement(F,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:r},this.getName()):!g&&o?m.a.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},m.a.createElement("input",{ref:this.selectFileNameFromRef,type:"text",value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0})):m.a.createElement("a",{href:r,download:"download",onClick:this.handleFileClick},this.getName())),d&&(o||l||(w=m.a.createElement("span",{className:"size"},m.a.createElement("small",null,V(this.props.size))))),p&&(o||l||(y=m.a.createElement("span",{className:"modified"},"Last modified: ",Object($.formatDistanceToNow)(this.props.modified,{addSuffix:!0}))));let v={};i&&(v={onClick:this.handleItemClick});let D=m.a.createElement("li",((e,t)=>{for(var r in t||(t={}))J.call(t,r)&&X(e,r,t[r]);if(U)for(var r of U(t))Q.call(t,r)&&X(e,r,t[r]);return e})({className:S()("file",{pending:t,dragging:n,dragover:s,selected:a}),id:h.generateId&&h.generateId(this.props.fileKey),onDoubleClick:this.handleItemDoubleClick},v),m.a.createElement("div",{className:"item"},m.a.createElement("span",{className:"thumb"},f),m.a.createElement("span",{className:"name"},b),w,y));return"function"==typeof h.moveFile&&(D=u(D)),this.connectDND(D)}}((e,t,r)=>{X(e,"symbol"!=typeof t?t+"":t,r)})(Z,"defaultProps",{showName:!0,showSize:!0,showModified:!0,isSelectable:!0});var ee=H()(Object(g.DragSource)("file",I.dragSource,I.dragCollect),Object(g.DropTarget)(["file","folder",F.NativeTypes.FILE],I.targetSource,I.targetCollect))(Z),te=Object.defineProperty,re=Object.defineProperties,ne=Object.getOwnPropertyDescriptors,oe=Object.getOwnPropertySymbols,ae=Object.prototype.hasOwnProperty,ie=Object.prototype.propertyIsEnumerable,se=(e,t,r)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r;class le extends m.a.Component{render(){return m.a.createElement(ee,((e,t)=>re(e,ne(t)))(((e,t)=>{for(var r in t||(t={}))ae.call(t,r)&&se(e,r,t[r]);if(oe)for(var r of oe(t))ie.call(t,r)&&se(e,r,t[r]);return e})({},this.props),{showName:!1,showSize:!1,showModified:!1,isSelectable:!1}))}}var ce=le,de=Object.defineProperty,pe=(e,t,r)=>(((e,t,r)=>{t in e?de(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class he extends m.a.Component{constructor(e){super(e),pe(this,"dateTimeFormats",(new Map).set("@distanceToNow",e=>Object($.formatDistanceToNow)(e,{addSuffix:!0}))),this.state={formats:e.formats.slice(0,2)}}getDateTime(e,t){return t?this.dateTimeFormats.has(t)?this.dateTimeFormats.get(t)(e):Object($.format)(e,t):null}render(){const{modified:e}=this.props,{formats:t}=this.state,r=t[0]||"@distanceToNow",n=t[1],o=this.getDateTime(e,r)||"-",a=this.getDateTime(e,n);return m.a.createElement("div",{title:a,onClick:()=>{a&&this.setState(()=>({formats:[n,r]}))}},o)}}pe(he,"propTypes",{formats:u.a.array,modified:u.a.number.isRequired});class ue extends _{render(){const{isDragging:e,isDeleting:t,isRenaming:r,isOver:n,isSelected:o,action:a,url:i,browserProps:s,connectDragPreview:l,depth:c,size:d,modified:p,modifiedDateTime:h}=this.props,u=s.icons[this.getFileType()]||s.icons.File,f=e||a,g=s.confirmDeletionRenderer;let F;F=!f&&t&&1===s.selection.length?m.a.createElement(g,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:i},u,this.getName()):!f&&r?m.a.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},u,m.a.createElement("input",{ref:this.selectFileNameFromRef,type:"text",value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0})):m.a.createElement("a",{href:i||"#",download:"download",onClick:this.handleFileClick},u,this.getName());let b=m.a.createElement("div",null,F);"function"==typeof s.moveFile&&(b=l(b));const w=m.a.createElement("tr",{className:S()("file",{pending:a,dragging:e,dragover:n,selected:o}),id:s.generateId&&s.generateId(this.props.fileKey),onClick:this.handleItemClick,onDoubleClick:this.handleItemDoubleClick},m.a.createElement("td",{className:"name"},m.a.createElement("div",{style:{paddingLeft:16*c+"px"}},b)),m.a.createElement("td",{className:"size"},V(d)),m.a.createElement("td",{className:"modified"},void 0===p?"-":m.a.createElement(he,{modified:p,formats:(null==h?void 0:h.formats)||[]})));return this.connectDND(w)}}var fe=H()(Object(g.DragSource)("file",I.dragSource,I.dragCollect),Object(g.DropTarget)(["file","folder",F.NativeTypes.FILE],I.targetSource,I.targetCollect))(ue),me=Object.defineProperty,ge=(e,t,r)=>(((e,t,r)=>{t in e?me(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r),r);class Fe extends m.a.Component{constructor(){super(...arguments),ge(this,"state",{newName:this.props.isDraft?"New folder":this.getName()}),ge(this,"handleFolderClick",e=>{e.stopPropagation(),this.props.browserProps.select(this.props.fileKey,"folder",e.ctrlKey||e.metaKey,e.shiftKey)}),ge(this,"handleFolderDoubleClick",e=>{e.stopPropagation(),this.toggleFolder()}),ge(this,"handleRenameClick",e=>{this.props.browserProps.renameFolder&&this.props.browserProps.beginAction("rename",this.props.fileKey)}),ge(this,"handleNewNameChange",e=>{const t=e.target.value;this.setState({newName:t})}),ge(this,"handleRenameSubmit",e=>{if(e.preventDefault(),e.stopPropagation(),!this.props.browserProps.renameFolder&&!this.props.isDraft)return;const t=this.state.newName.trim();if(0===t.length)return;if(["/","\\"].some(e=>-1!==t.indexOf(e)))return;let r=this.props.fileKey.substr(0,this.props.fileKey.substr(0,this.props.fileKey.length-1).lastIndexOf("/"));r.length&&(r+="/"),r+=t,r+="/",this.props.isDraft?this.props.browserProps.createFolder(r):this.props.browserProps.renameFolder(this.props.fileKey,r)}),ge(this,"handleDeleteClick",e=>{this.props.browserProps.deleteFolder&&this.props.browserProps.beginAction("delete",this.props.fileKey)}),ge(this,"handleDeleteSubmit",e=>{e.preventDefault(),e.stopPropagation(),this.props.browserProps.deleteFolder&&this.props.browserProps.deleteFolder(this.props.browserProps.actionTargets)}),ge(this,"handleCancelEdit",e=>{this.props.browserProps.endAction()}),ge(this,"toggleFolder",()=>{this.props.browserProps.toggleFolder(this.props.fileKey)})}selectFolderNameFromRef(e){if(e){const t=e.value;e.setSelectionRange(0,t.length),e.focus()}}getName(){if(this.props.name)return this.props.name;const e=this.props.fileKey.split("/");return this.props.newName||e[e.length-2]}connectDND(e){const t=this.props.isDragging||this.props.action;return this.props.keyDerived&&("function"!=typeof this.props.browserProps.moveFolder||t||this.props.isRenaming||this.props.isDeleting||(e=this.props.connectDragSource(e)),"function"!=typeof this.props.browserProps.createFiles&&"function"!=typeof this.props.browserProps.moveFolder&&"function"!=typeof this.props.browserProps.moveFile||(e=this.props.connectDropTarget(e))),e}}ge(Fe,"propTypes",{name:u.a.string,fileKey:u.a.string,newName:u.a.string,keyDerived:u.a.bool,isDraft:u.a.bool,isRenaming:u.a.bool,isDeleting:u.a.bool,connectDragSource:u.a.func,connectDropTarget:u.a.func,isDragging:u.a.bool,action:u.a.string,browserProps:u.a.shape({nameFilter:u.a.string,select:u.a.func,toggleFolder:u.a.func,openFolder:u.a.func,beginAction:u.a.func,endAction:u.a.func,preview:u.a.func,createFiles:u.a.func,createFolder:u.a.func,moveFile:u.a.func,moveFolder:u.a.func,renameFolder:u.a.func,deleteFolder:u.a.func})});const be={dragSource:{beginDrag:e=>(e.browserProps.selection.length||e.browserProps.select(e.fileKey,"folder"),{key:e.fileKey}),endDrag(e,t,r){k(e,t)}},dragCollect:function(e,t){return{connectDragPreview:e.dragPreview(),connectDragSource:e.dragSource(),isDragging:t.isDragging()}}};var we=Fe,ye=Object.defineProperty,ve=Object.defineProperties,De=Object.getOwnPropertyDescriptors,Ee=Object.getOwnPropertySymbols,Pe=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable,Re=(e,t,r)=>t in e?ye(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Ce=(e,t)=>{for(var r in t||(t={}))Pe.call(t,r)&&Re(e,r,t[r]);if(Ee)for(var r of Ee(t))Oe.call(t,r)&&Re(e,r,t[r]);return e},Se=(e,t)=>ve(e,De(t));class Ne extends we{render(){const{isOpen:e,isDragging:t,isDeleting:r,isRenaming:n,isDraft:o,isOver:a,isSelected:i,url:s,action:l,browserProps:c,depth:d,keyDerived:p,connectDragPreview:h}=this.props,u=c.icons[e?"FolderOpen":"Folder"],f=t||l,g=c.confirmDeletionRenderer;let F,b;if(F=!f&&r&&1===c.selection.length?m.a.createElement(g,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:s},this.getName()):!f&&n||o?m.a.createElement("div",null,m.a.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},m.a.createElement("input",{type:"text",ref:this.selectFolderNameFromRef,value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0}))):m.a.createElement("div",null,m.a.createElement("a",{onClick:this.toggleFolder},this.getName())),e&&c.nestChildren){b=[];for(let e=0;e<b.length;e++){const t=b[e],r=Se(Ce({},c.getItemProps(t,c)),{depth:d+1});N(t)?b.push(m.a.createElement(c.folderRenderer,Ce(Se(Ce(Ce({},t),r),{browserProps:c}),c.folderRendererProps))):b.push(m.a.createElement(c.fileRenderer,Ce(Se(Ce(Ce({},t),r),{browserProps:c}),c.fileRendererProps)))}b=b.length?m.a.createElement("ul",{style:{padding:"0 8px",paddingLeft:"16px"}},b):m.a.createElement("p",null,"No items in this folder")}let w=m.a.createElement("li",{className:S()("folder",{expanded:e&&c.nestChildren,pending:l,dragging:t,dragover:a,selected:i}),id:c.generateId&&c.generateId(this.props.fileKey),onClick:this.handleFolderClick,onDoubleClick:this.handleFolderDoubleClick},m.a.createElement("div",{className:"item"},m.a.createElement("span",{className:"thumb"},u),m.a.createElement("span",{className:"name"},F)),b);return"function"==typeof c.moveFolder&&p&&(w=h(w)),this.connectDND(w)}}var ke=H()(Object(g.DragSource)("folder",be.dragSource,be.dragCollect),Object(g.DropTarget)(["file","folder",F.NativeTypes.FILE],I.targetSource,I.targetCollect))(Ne);class Te extends we{render(){const{isOpen:e,isDragging:t,isDeleting:r,isRenaming:n,isDraft:o,isOver:a,isSelected:i,action:s,url:l,browserProps:c,connectDragPreview:d,depth:p}=this.props,h=c.icons[e?"FolderOpen":"Folder"],u=t||s,f=c.confirmDeletionRenderer;let g;g=!u&&r&&1===c.selection.length?m.a.createElement(f,{handleDeleteSubmit:this.handleDeleteSubmit,handleFileClick:this.handleFileClick,url:l},h,this.getName()):!u&&n||o?m.a.createElement("div",null,m.a.createElement("form",{className:"renaming",onSubmit:this.handleRenameSubmit},h,m.a.createElement("input",{type:"text",ref:this.selectFolderNameFromRef,value:this.state.newName,onChange:this.handleNewNameChange,onBlur:this.handleCancelEdit,autoFocus:!0}))):m.a.createElement("div",null,m.a.createElement("a",{onClick:this.toggleFolder},h,this.getName()));let F=m.a.createElement("div",null,g);"function"==typeof c.moveFile&&(F=d(F));const b=m.a.createElement("tr",{className:S()("folder",{pending:s,dragging:t,dragover:a,selected:i}),id:c.generateId&&c.generateId(this.props.fileKey),onClick:this.handleFolderClick,onDoubleClick:this.handleFolderDoubleClick},m.a.createElement("td",{className:"name"},m.a.createElement("div",{style:{paddingLeft:16*p+"px"}},F)),m.a.createElement("td",null),m.a.createElement("td",null));return this.connectDND(b)}}var je=H()(Object(g.DragSource)("folder",be.dragSource,be.dragCollect),Object(g.DropTarget)(["file","folder",F.NativeTypes.FILE],I.targetSource,I.targetCollect))(Te);const Ae=e=>{const{children:t,handleDeleteSubmit:r,handleFileClick:n,url:o}=e;return m.a.createElement("form",{className:"deleting",onSubmit:r},m.a.createElement("a",{href:o,download:"download",onClick:n},t),m.a.createElement("div",null,m.a.createElement("button",{type:"submit"},"Confirm Deletion")))};Ae.propTypes={children:u.a.node,handleDeleteSubmit:u.a.func,handleFileClick:u.a.func,url:u.a.string},Ae.defaultProps={url:"#"};var xe=Ae;const Me=e=>{const{handleDeleteSubmit:t}=e;return m.a.createElement("button",{className:"deleting",onClick:t},"Confirm Deletion")};Me.propTypes={handleDeleteSubmit:u.a.func};var Ie=Me,Ke=Object.defineProperty,Be=Object.defineProperties,Le=Object.getOwnPropertyDescriptors,_e=Object.getOwnPropertySymbols,qe=Object.prototype.hasOwnProperty,ze=Object.prototype.propertyIsEnumerable,We=(e,t,r)=>t in e?Ke(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,$e=(e,t)=>{for(var r in t||(t={}))qe.call(t,r)&&We(e,r,t[r]);if(_e)for(var r of _e(t))ze.call(t,r)&&We(e,r,t[r]);return e},Ge=(e,t)=>Be(e,Le(t)),He=function(e,t){const r={contents:[],children:{}};return e.map(e=>{e.relativeKey=(e.newKey||e.key).substr(t.length);let n=r;const o=e.relativeKey.split("/");o.map((t,r)=>{if(r===o.length-1&&N(e))for(const t in e)n[t]=e[t];if(""===t)return;!N(e)&&r===o.length-1?n.contents.push(Ge($e({},e),{keyDerived:!0})):(t in n.children==!1&&(n.children[t]={contents:[],children:{}}),n=n.children[t])})}),e=function e(r,n){""!==n&&(n+="/");let o=[];for(const a in r.children)o.push(Ge($e({},r.children[a]),{contents:void 0,keyDerived:!0,key:t+n+a+"/",relativeKey:n+a+"/",children:e(r.children[a],n+a),size:0}));return o=o.concat(r.contents),o}(r,"")};var Ve=Object.defineProperty,Ye=Object.defineProperties,Ue=Object.getOwnPropertyDescriptors,Je=Object.getOwnPropertySymbols,Qe=Object.prototype.hasOwnProperty,Xe=Object.prototype.propertyIsEnumerable,Ze=(e,t,r)=>t in e?Ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,et=(e,t)=>{for(var r in t||(t={}))Qe.call(t,r)&&Ze(e,r,t[r]);if(Je)for(var r of Je(t))Xe.call(t,r)&&Ze(e,r,t[r]);return e},tt=function(e,t){const r=function(){const e=[],t=new Date;return e.push({name:"Today",begins:Object($.startOfToday)(),ends:Object($.endOfToday)(),items:[]}),e.push({name:"Yesterday",begins:Object($.startOfYesterday)(),ends:Object($.endOfYesterday)(),items:[]}),e.push({name:"Earlier this Week",begins:Object($.startOfWeek)(t),ends:Object($.endOfWeek)(t),items:[]}),e.push({name:"Last Week",begins:Object($.startOfWeek)(Object($.addWeeks)(t,-1)),ends:Object($.endOfWeek)(Object($.addWeeks)(t,-1)),items:[]}),Object($.getMonth)(e[e.length-1].begins)===Object($.getMonth)(t)&&e.push({name:"Earlier this Month",begins:Object($.startOfMonth)(t),ends:Object($.endOfMonth)(t),items:[]}),e}();for(let t=0;t<e.length;t++){const o=e[t];if(N(o))continue;const a=(n=et({},o),Ye(n,Ue({keyDerived:!0})));let i=!1;const s=+a.modified;for(let e=0;e<r.length;e++){const t=r[e];if(s>+t.begins&&s<=+t.ends){t.items.push(a),i=!0;break}}if(!i){const e={name:Object($.format)(a.modified,"MMMM yyyy"),begins:Object($.startOfMonth)(a.modified),ends:Object($.endOfMonth)(a.modified),items:[]};e.items.push(a),r.push(e)}}var n;const o=[];for(let e=0;e<r.length;e++){const t=r[e];t.items.length&&o.push({key:t.name.toLowerCase().replace(" ","_")+"/",name:t.name,children:t.items,size:0})}return o};const rt=/(-?\d*\.?\d+)/g;function nt(e,t){const r=String(e.name).split(rt),n=String(t.name).split(rt),o=Math.min(r.length,n.length);for(let e=0;e<o;e++){const t=parseFloat(r[e])||r[e].toLowerCase(),o=parseFloat(n[e])||n[e].toLowerCase();if(t<o)return-1;if(t>o)return 1}return 0}function ot(e,t){return e.draft&&!t.draft?1:t.draft&&!e.draft?-1:nt(e,t)}var at=function(e){return function e(t){let r=[],n=[];for(let e=0;e<t.length;e++){const o=t[e],a=(o.newKey||o.key).split("/");o.children?(o.name||(o.name=a[a.length-2]),r.push(o)):(o.name||(o.name=a[a.length-1]),n.push(o))}n=n.sort(nt),r=r.sort(ot);for(let t=0;t<r.length;t++){const n=r[t];n.children=e(n.children)}let o=[];return o=o.concat(r),o=o.concat(n),o}(e)};var it=function(e){return function e(t){const r=[];let n=[];for(let e=0;e<t.length;e++){const o=t[e],a=(o.newKey||o.key).split("/");o.children?r.push(o):(o.name=a[a.length-1],n.push(o))}n=n.sort($.compareAsc);for(let t=0;t<r.length;t++){const n=r[t];n.children=e(n.children)}let o=[];return o=o.concat(r),o=o.concat(n),o}(e)};const st=e=>{const{selectedItems:t,isFolder:r,icons:n,nameFilter:o,canCreateFolder:a,onCreateFolder:i,canRenameFile:s,onRenameFile:l,canRenameFolder:c,onRenameFolder:d,canDeleteFile:p,onDeleteFile:h,canDeleteFolder:u,onDeleteFolder:f,canDownloadFile:g,onDownloadFile:F,canDownloadFolder:b,onDownloadFolder:w}=e;let y=[];if(t.length){const e=t.filter(e=>e.action);if(e.length===t.length&&1===[...new Set(e)].length){let t;switch(e[0].action){case"delete":t="Deleting ...";break;case"rename":t="Renaming ...";break;default:t="Moving ..."}y=m.a.createElement("div",{className:"item-actions"},n.Loading," ",t)}else{r&&a&&!o&&y.push(m.a.createElement("li",{key:"action-add-folder"},m.a.createElement("a",{onClick:i,href:"#",role:"button"},n.Folder," Add Subfolder")));const e=t.find(e=>!e.keyDerived);e||r||!s||1!==t.length?!e&&r&&c&&y.push(m.a.createElement("li",{key:"action-rename"},m.a.createElement("a",{onClick:d,href:"#",role:"button"},n.Rename," Rename"))):y.push(m.a.createElement("li",{key:"action-rename"},m.a.createElement("a",{onClick:l,href:"#",role:"button"},n.Rename," Rename"))),e||r||!p?!e&&r&&u&&y.push(m.a.createElement("li",{key:"action-delete"},m.a.createElement("a",{onClick:f,href:"#",role:"button"},n.Delete," Delete"))):y.push(m.a.createElement("li",{key:"action-delete"},m.a.createElement("a",{onClick:h,href:"#",role:"button"},n.Delete," Delete"))),(!r&&g||r&&b)&&y.push(m.a.createElement("li",{key:"action-download"},m.a.createElement("a",{onClick:r?w:F,href:"#",role:"button"},n.Download," Download"))),y=y.length?m.a.createElement("ul",{className:"item-actions"},y):m.a.createElement("div",{className:"item-actions"}," ")}}else a&&!o&&y.push(m.a.createElement("li",{key:"action-add-folder"},m.a.createElement("a",{onClick:i,href:"#",role:"button"},n.Folder," Add Folder"))),y=y.length?m.a.createElement("ul",{className:"item-actions"},y):m.a.createElement("div",{className:"item-actions"}," ");return y};st.propTypes={selectedItems:u.a.arrayOf(u.a.object),isFolder:u.a.bool,icons:u.a.object,nameFilter:u.a.string,canCreateFolder:u.a.bool,onCreateFolder:u.a.func,canRenameFile:u.a.bool,onRenameFile:u.a.func,canRenameFolder:u.a.bool,onRenameFolder:u.a.func,canDeleteFile:u.a.bool,onDeleteFile:u.a.func,canDeleteFolder:u.a.bool,onDeleteFolder:u.a.func,canDownloadFile:u.a.bool,onDownloadFile:u.a.func,canDownloadFolder:u.a.bool,onDownloadFolder:u.a.func},st.defaultProps={selectedItems:[],isFolder:!1,icons:{},nameFilter:"",canCreateFolder:!1,onCreateFolder:null,canRenameFile:!1,onRenameFile:null,canRenameFolder:!1,onRenameFolder:null,canDeleteFile:!1,onDeleteFile:null,canDeleteFolder:!1,onDeleteFolder:null,canDownloadFile:!1,onDownloadFile:null,canDownloadFolder:!1,onDownloadFolder:null};var lt=st,ct=Object.defineProperty;class dt extends m.a.Component{render(){const{filter:e,actions:t}=this.props;return m.a.createElement("div",{className:"action-bar"},e,t)}}((e,t,r)=>{((e,t,r)=>{t in e?ct(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r})(e,"symbol"!=typeof t?t+"":t,r)})(dt,"propTypes",{filter:u.a.element,actions:u.a.element});var pt=Object.defineProperty,ht=Object.defineProperties,ut=Object.getOwnPropertyDescriptors,ft=Object.getOwnPropertySymbols,mt=Object.prototype.hasOwnProperty,gt=Object.prototype.propertyIsEnumerable,Ft=(e,t,r)=>t in e?pt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,bt=(e,t)=>{for(var r in t||(t={}))mt.call(t,r)&&Ft(e,r,t[r]);if(ft)for(var r of ft(t))gt.call(t,r)&&Ft(e,r,t[r]);return e},wt=(e,t)=>ht(e,ut(t)),yt=(e,t,r)=>(Ft(e,"symbol"!=typeof t?t+"":t,r),r);const vt=/.*\/__new__[/]?$/gm;function Dt(e,t){return{key:"file-"+e.key,fileKey:e.key,isSelected:t.selection.includes(e.key),isOpen:e.key in t.openFolders||t.assumeOpenOnFilter&&t.nameFilter,isRenaming:"rename"===t.activeAction&&t.actionTargets.includes(e.key),isDeleting:"delete"===t.activeAction&&t.actionTargets.includes(e.key),isDraft:!!e.draft}}class Et extends m.a.Component{constructor(){super(...arguments),yt(this,"state",{openFolders:{},selection:[],activeAction:null,actionTargets:[],nameFilter:"",searchResultsShown:this.props.searchResultsPerPage,previewFile:null,addFolder:null}),yt(this,"getFile",e=>{let t=!1;const r=this.props.files.find(r=>(r.key.startsWith(e)&&(t=!0),r.key===e));return r||(t?{key:e,modified:0,size:0,relativeKey:e}:void 0)}),yt(this,"createFiles",(e,t)=>{this.setState(e=>{const r={selection:[]};return t&&(r.openFolders=wt(bt({},e.openFolders),{[t]:!0})),r},()=>{this.props.onCreateFiles(e,t)})}),yt(this,"createFolder",e=>{this.setState({activeAction:null,actionTargets:[],selection:[e]},()=>{this.props.onCreateFolder(e)})}),yt(this,"moveFile",(e,t)=>{this.setState({activeAction:null,actionTargets:[],selection:[t]},()=>{this.props.onMoveFile(e,t)})}),yt(this,"moveFolder",(e,t)=>{this.setState(r=>{const n={activeAction:null,actionTargets:[],selection:[t]};return e in r.openFolders&&(n.openFolders=wt(bt({},r.openFolders),{[t]:!0})),n},()=>{this.props.onMoveFolder(e,t)})}),yt(this,"renameFile",(e,t)=>{this.setState({activeAction:null,actionTargets:[],selection:[t]},()=>{this.props.onRenameFile(e,t)})}),yt(this,"renameFolder",(e,t)=>{this.setState(r=>{const n={activeAction:null,actionTargets:[]};return r.selection[0].substr(0,e.length)===e&&(n.selection=[r.selection[0].replace(e,t)]),e in r.openFolders&&(n.openFolders=wt(bt({},r.openFolders),{[t]:!0})),n},()=>{this.props.onRenameFolder(e,t)})}),yt(this,"deleteFile",e=>{this.setState({activeAction:null,actionTargets:[],selection:[]},()=>{this.props.onDeleteFile(e)})}),yt(this,"deleteFolder",e=>{this.setState(t=>{const r={activeAction:null,actionTargets:[],selection:[]};return e in t.openFolders&&(r.openFolders=bt({},t.openFolders),delete r.openFolders[e]),r},()=>{this.props.onDeleteFolder(e)})}),yt(this,"downloadFile",e=>{this.setState({activeAction:null,actionTargets:[]},()=>{this.props.onDownloadFile(e)})}),yt(this,"downloadFolder",e=>{this.setState({activeAction:null,actionTargets:[]},()=>{this.props.onDownloadFolder(e)})}),yt(this,"beginAction",(e,t)=>{this.setState({activeAction:e,actionTargets:t||[]})}),yt(this,"endAction",()=>{this.state.selection&&this.state.selection.length>0&&this.state.selection.filter(e=>e.match(vt)).length>0&&this.setState({selection:[]}),this.beginAction(null,null)}),yt(this,"select",(e,t,r,n)=>{const{actionTargets:o}=this.state,a=o.length&&!o.includes(e),i=this.getFile(e);let s=[e];if(r||n){const t=this.state.selection.indexOf(e);s=-1!==t?[...this.state.selection.slice(0,t),...this.state.selection.slice(t+1)]:[...this.state.selection,e]}this.setState(e=>({selection:s,actionTargets:a?[]:o,activeAction:a?null:e.activeAction}),()=>{this.props.onSelect(i),"file"===t&&this.props.onSelectFile(i),"folder"===t&&this.props.onSelectFolder(i)})}),yt(this,"preview",e=>{this.state.previewFile&&this.state.previewFile.key!==e.key&&this.closeDetail(),this.setState({previewFile:e},()=>{this.props.onPreviewOpen(e)})}),yt(this,"closeDetail",()=>{this.setState({previewFile:null},()=>{this.props.onPreviewClose(this.state.previewFile)})}),yt(this,"handleShowMoreClick",e=>{e.preventDefault(),this.setState(e=>({searchResultsShown:e.searchResultsShown+this.props.searchResultsPerPage}))}),yt(this,"toggleFolder",e=>{const t=e in this.state.openFolders;this.setState(r=>{const n={openFolders:bt({},r.openFolders)};return t?delete n.openFolders[e]:n.openFolders[e]=!0,n},()=>{const r=t?"onFolderClose":"onFolderOpen";this.props[r](this.getFile(e),this.getBrowserProps())})}),yt(this,"openFolder",e=>{this.setState(t=>({openFolders:wt(bt({},t.openFolders),{[e]:!0})}),()=>{this.props.onFolderOpen(this.getFile(e),this.getBrowserProps())})}),yt(this,"setOpenFolders",e=>{this.setState(t=>({openFolders:e.reduce((e,t)=>wt(bt({},e),{[t]:!0}),{})}))}),yt(this,"handleGlobalClick",e=>{!(!this.browserRef||!this.browserRef.contains(e.target))||this.setState({selection:[],actionTargets:[],activeAction:null})}),yt(this,"handleActionBarRenameClick",e=>{e.preventDefault(),this.beginAction("rename",this.state.selection)}),yt(this,"handleActionBarDeleteClick",e=>{e.preventDefault(),this.beginAction("delete",this.state.selection)}),yt(this,"handleActionBarAddFolderClick",e=>{e.preventDefault(),"createFolder"!==this.state.activeAction&&this.setState(e=>{let t="";e.selection&&e.selection.length>0&&(t+=e.selection,"/"!==t.substr(t.length-1,t.length)&&(t+="/")),"__new__/"===t||t.endsWith("/__new__/")||(t+="__new__/");const r={actionTargets:[t],activeAction:"createFolder",selection:[t]};return e.selection&&e.selection.length>0&&(r.openFolders=wt(bt({},e.openFolders),{[this.state.selection]:!0})),r})}),yt(this,"handleActionBarDownloadClick",e=>{e.preventDefault();const t=this.getFiles(),r=this.getSelectedItems(t);1===r.length&&N(r[0])?this.downloadFolder(this.state.selection):this.downloadFile(this.state.selection)}),yt(this,"updateFilter",e=>{this.setState({nameFilter:e,searchResultsShown:this.props.searchResultsPerPage})}),yt(this,"handleMultipleDeleteSubmit",()=>{console.log(this),this.deleteFolder(this.state.selection.filter(e=>"/"===e[e.length-1])),this.deleteFile(this.state.selection.filter(e=>"/"!==e[e.length-1]))})}componentDidMount(){"table"===this.props.renderStyle&&this.props.nestChildren&&console.warn("Invalid settings: Cannot nest table children in file browser"),window.addEventListener("click",this.handleGlobalClick)}componentWillUnmount(){window.removeEventListener("click",this.handleGlobalClick)}getBrowserProps(){return{nestChildren:this.props.nestChildren,fileRenderer:this.props.fileRenderer,fileRendererProps:this.props.fileRendererProps,folderRenderer:this.props.folderRenderer,folderRendererProps:this.props.folderRendererProps,confirmDeletionRenderer:this.props.confirmDeletionRenderer,confirmMultipleDeletionRenderer:this.props.confirmMultipleDeletionRenderer,icons:this.props.icons,assumeOpenOnFilter:this.props.assumeOpenOnFilter,generateId:this.props.generateId,openFolders:this.state.openFolders,nameFilter:this.state.nameFilter,selection:this.state.selection,activeAction:this.state.activeAction,actionTargets:this.state.actionTargets,select:this.select,openFolder:this.openFolder,toggleFolder:this.toggleFolder,beginAction:this.beginAction,endAction:this.endAction,preview:this.preview,updateFilter:this.updateFilter,createFiles:this.props.onCreateFiles?this.createFiles:void 0,createFolder:this.props.onCreateFolder?this.createFolder:void 0,renameFile:this.props.onRenameFile?this.renameFile:void 0,renameFolder:this.props.onRenameFolder?this.renameFolder:void 0,moveFile:this.props.onMoveFile?this.moveFile:void 0,moveFolder:this.props.onMoveFolder?this.moveFolder:void 0,deleteFile:this.props.onDeleteFile?this.deleteFile:void 0,deleteFolder:this.props.onDeleteFolder?this.deleteFolder:void 0,getItemProps:Dt}}renderActionBar(e){const{icons:t,canFilter:r,filterRendererProps:n,filterRenderer:o,actionBarRenderer:a,actionRenderer:i,onCreateFolder:s,onRenameFile:l,onRenameFolder:c,onDeleteFile:d,onDeleteFolder:p,onDownloadFile:h,onDownloadFolder:u}=this.props,f=this.getBrowserProps(),g=1===e.length&&N(e[0]);let F;r&&(F=m.a.createElement(o,bt({value:this.state.nameFilter,updateFilter:this.updateFilter},n)));const b=m.a.createElement(i,{browserProps:f,selectedItems:e,isFolder:g,icons:t,nameFilter:this.state.nameFilter,canCreateFolder:"function"==typeof s,onCreateFolder:this.handleActionBarAddFolderClick,canRenameFile:"function"==typeof l,onRenameFile:this.handleActionBarRenameClick,canRenameFolder:"function"==typeof c,onRenameFolder:this.handleActionBarRenameClick,canDeleteFile:"function"==typeof d,onDeleteFile:this.handleActionBarDeleteClick,canDeleteFolder:"function"==typeof p,onDeleteFolder:this.handleActionBarDeleteClick,canDownloadFile:"function"==typeof h,onDownloadFile:this.handleActionBarDownloadClick,canDownloadFolder:"function"==typeof u,onDownloadFolder:this.handleActionBarDownloadClick});return m.a.createElement(a,{filter:F,actions:b})}renderFiles(e,t){const{fileRenderer:r,fileRendererProps:n,folderRenderer:o,folderRendererProps:a,flattenFilterResults:i}=this.props,s=this.getBrowserProps();let l=[];return e.map(e=>{const c=wt(bt({},s.getItemProps(e,s)),{depth:this.state.nameFilter&&i?0:t});N(e)?(!this.props.showFoldersOnFilter&&this.state.nameFilter||l.push(m.a.createElement(o,bt(wt(bt(bt({},e),c),{browserProps:s}),a))),(this.state.nameFilter||c.isOpen&&!s.nestChildren)&&(l=l.concat(this.renderFiles(e.children,t+1)))):l.push(m.a.createElement(r,bt(wt(bt(bt({},e),c),{browserProps:s}),n)))}),l}getFiles(){let e=this.props.files.concat([]);if("createFolder"===this.state.activeAction&&e.push({key:this.state.actionTargets[0],size:0,draft:!0}),this.state.nameFilter&&(e=this.props.getFilteredFiles(this.state.nameFilter,e)),"function"==typeof this.props.group)e=this.props.group(e,"");else{const t=[];e.map(e=>{N(e)||t.push(e)}),e=t}return"function"==typeof this.props.sort&&(e=this.props.sort(e)),e}getSelectedItems(e){const{selection:t}=this.state,r=[],n=e=>{t.includes(e.key)&&r.push(e),e.children&&e.children.map(n)};return e.map(n),r}render(){const e={browserProps:this.getBrowserProps(),fileKey:"",fileCount:this.props.files.length};let t;const r=this.getFiles(),n=this.getSelectedItems(r);let o,a=this.renderFiles(r,0);switch(this.props.renderStyle){case"table":if(a.length){if(this.state.nameFilter){const e=a.length;a=a.slice(0,this.state.searchResultsShown),e>a.length&&a.push(m.a.createElement("tr",{key:"show-more",className:"show-more-row"},m.a.createElement("td",{colSpan:100},m.a.createElement("a",{onClick:this.handleShowMoreClick,href:"#",className:"show-more"},this.props.showMoreResults))))}}else a=this.state.nameFilter?m.a.createElement("tr",null,m.a.createElement("td",{colSpan:100},this.props.noMatchingFilesMessage(this.state.nameFilter))):m.a.createElement("tr",null,m.a.createElement("td",{colSpan:100},this.props.noFilesMessage));this.props.headerRenderer&&(o=m.a.createElement("thead",null,m.a.createElement(this.props.headerRenderer,bt(bt({},e),this.props.headerRendererProps)))),t=m.a.createElement("table",{cellSpacing:"0",cellPadding:"0"},o,m.a.createElement("tbody",null,a));break;case"list":if(a.length){let e;if(this.state.nameFilter){const t=a.length;a=a.slice(0,this.state.searchResultsShown),t>a.length&&(e=m.a.createElement("a",{onClick:this.handleShowMoreClick,href:"#",className:"show-more"},this.props.showMoreResults))}a=m.a.createElement("div",null,m.a.createElement("ul",null,a),e)}else a=this.state.nameFilter?m.a.createElement("p",{className:"empty"},this.props.noMatchingFilesMessage(this.state.nameFilter)):m.a.createElement("p",{className:"empty"},this.props.noFilesMessage);this.props.headerRenderer&&(o=m.a.createElement(this.props.headerRenderer,bt(bt({},e),this.props.headerRendererProps))),t=m.a.createElement("div",null,o,a)}const i=this.props.confirmMultipleDeletionRenderer;return m.a.createElement("div",{className:"rendered-react-keyed-file-browser"},this.props.actions,m.a.createElement("div",{className:"rendered-file-browser",ref:e=>{this.browserRef=e}},this.props.showActionBar&&this.renderActionBar(n),"delete"===this.state.activeAction&&this.state.selection.length>1&&m.a.createElement(i,{handleDeleteSubmit:this.handleMultipleDeleteSubmit}),m.a.createElement("div",{className:"files"},t)),null!==this.state.previewFile&&m.a.createElement(this.props.detailRenderer,bt({file:this.state.previewFile,close:this.closeDetail},this.props.detailRendererProps)))}}yt(Et,"propTypes",{files:u.a.arrayOf(u.a.shape({key:u.a.string.isRequired,modified:u.a.number,size:u.a.number})).isRequired,actions:u.a.node,showActionBar:u.a.bool.isRequired,canFilter:u.a.bool.isRequired,showFoldersOnFilter:u.a.bool,noFilesMessage:u.a.oneOfType([u.a.string,u.a.object]),noMatchingFilesMessage:u.a.func,showMoreResults:u.a.oneOfType([u.a.string,u.a.object]),getFilteredFiles:u.a.func,flattenFilterResults:u.a.bool,assumeOpenOnFilter:u.a.bool,searchResultsPerPage:u.a.number,group:u.a.func.isRequired,sort:u.a.func.isRequired,generateId:u.a.func,icons:u.a.shape({Folder:u.a.element,FolderOpen:u.a.element,File:u.a.element,PDF:u.a.element,Image:u.a.element,Delete:u.a.element,Rename:u.a.element,Loading:u.a.element,Download:u.a.element}),nestChildren:u.a.bool.isRequired,renderStyle:u.a.oneOf(["list","table"]).isRequired,startOpen:u.a.bool.isRequired,headerRenderer:u.a.func,headerRendererProps:u.a.object,filterRenderer:u.a.func,filterRendererProps:u.a.object,fileRenderer:u.a.func,fileRendererProps:u.a.object,folderRenderer:u.a.func,folderRendererProps:u.a.object,detailRenderer:u.a.func,detailRendererProps:u.a.object,actionRenderer:u.a.func,actionBarRenderer:u.a.func,confirmDeletionRenderer:u.a.func,confirmMultipleDeletionRenderer:u.a.func,onCreateFiles:u.a.oneOfType([u.a.func,u.a.bool]),onCreateFolder:u.a.oneOfType([u.a.func,u.a.bool]),onMoveFile:u.a.oneOfType([u.a.func,u.a.bool]),onMoveFolder:u.a.oneOfType([u.a.func,u.a.bool]),onRenameFile:u.a.oneOfType([u.a.func,u.a.bool]),onRenameFolder:u.a.oneOfType([u.a.func,u.a.bool]),onDeleteFile:u.a.oneOfType([u.a.func,u.a.bool]),onDeleteFolder:u.a.oneOfType([u.a.func,u.a.bool]),onDownloadFile:u.a.oneOfType([u.a.func,u.a.bool]),onDownloadFolder:u.a.oneOfType([u.a.func,u.a.bool]),onSelect:u.a.func,onSelectFile:u.a.func,onSelectFolder:u.a.func,onPreviewOpen:u.a.func,onPreviewClose:u.a.func,onFolderOpen:u.a.func,onFolderClose:u.a.func}),yt(Et,"defaultProps",{showActionBar:!0,canFilter:!0,showFoldersOnFilter:!1,noFilesMessage:"No files.",noMatchingFilesMessage:e=>`No files matching "${e}".`,showMoreResults:"Show more results",getFilteredFiles:R,flattenFilterResults:!0,assumeOpenOnFilter:!0,searchResultsPerPage:20,group:He,sort:at,generateId:void 0,nestChildren:!1,renderStyle:"table",startOpen:!1,headerRenderer:W,headerRendererProps:{},filterRenderer:O,filterRendererProps:{},fileRenderer:fe,fileRendererProps:{modifiedDateTime:{formats:["@distanceToNow"]}},folderRenderer:je,folderRendererProps:{},detailRenderer:v,detailRendererProps:{},actionRenderer:lt,actionBarRenderer:dt,confirmDeletionRenderer:xe,confirmMultipleDeletionRenderer:Ie,icons:{},onSelect:e=>{},onSelectFile:e=>{},onSelectFolder:e=>{},onPreviewOpen:e=>{},onPreviewClose:e=>{},onFolderOpen:e=>{},onFolderClose:e=>{}});var Pt=m.a.forwardRef((e,t)=>m.a.createElement(g.DndProvider,{backend:F.HTML5Backend},m.a.createElement(Et,bt({ref:t},e))));const Ot=e=>{const t=4===e?"fa":"fas",r=4===e?["FontAwesome",'"FontAwesome"']:['"Font Awesome 5 Free"','"Font Awesome 5 Pro"'];let n=!1;const o=document.createElement("span");o.className=t,o.style.display="none",document.body.insertBefore(o,document.body.firstChild);var a,i;return r.includes((a=o,i="font-family",window.getComputedStyle(a,null).getPropertyValue(i)))?n=!0:console.warn(`Font Awesome ${e} was not detected but Font Awesome ${e} icons have been requested for \`react-object-list\``),document.body.removeChild(o),n};var Rt=(e=4)=>{switch(e){case 4:return Ot(4),{File:m.a.createElement("i",{className:"fa fa-file-o","aria-hidden":"true"}),Image:m.a.createElement("i",{className:"fa fa-file-image-o","aria-hidden":"true"}),Video:m.a.createElement("i",{className:"fa fa-file-video-o","aria-hidden":"true"}),Audio:m.a.createElement("i",{className:"fa fa-file-audio-o","aria-hidden":"true"}),Archive:m.a.createElement("i",{className:"fa fa-file-archive-o","aria-hidden":"true"}),Word:m.a.createElement("i",{className:"fa fa-file-word-o","aria-hidden":"true"}),Excel:m.a.createElement("i",{className:"fa fa-file-excel-o","aria-hidden":"true"}),PowerPoint:m.a.createElement("i",{className:"fa fa-file-powerpoint-o","aria-hidden":"true"}),Text:m.a.createElement("i",{className:"fa fa-file-text-o","aria-hidden":"true"}),PDF:m.a.createElement("i",{className:"fa fa-file-pdf-o","aria-hidden":"true"}),Rename:m.a.createElement("i",{className:"fa fa-i-cursor","aria-hidden":"true"}),Folder:m.a.createElement("i",{className:"fa fa-folder-o","aria-hidden":"true"}),FolderOpen:m.a.createElement("i",{className:"fa fa-folder-open-o","aria-hidden":"true"}),Delete:m.a.createElement("i",{className:"fa fa-trash-o","aria-hidden":"true"}),Loading:m.a.createElement("i",{className:"fa fa-circle-o-notch fa-spin","aria-hidden":"true"}),Download:m.a.createElement("i",{className:"fa fa-download","aria-hidden":"true"})};case 5:return Ot(5),{File:m.a.createElement("i",{className:"far fa-file","aria-hidden":"true"}),Image:m.a.createElement("i",{className:"far fa-file-image","aria-hidden":"true"}),Video:m.a.createElement("i",{className:"far fa-file-video","aria-hidden":"true"}),Audio:m.a.createElement("i",{className:"far fa-file-audio","aria-hidden":"true"}),Archive:m.a.createElement("i",{className:"far fa-file-archive","aria-hidden":"true"}),Word:m.a.createElement("i",{className:"far fa-file-word","aria-hidden":"true"}),Excel:m.a.createElement("i",{className:"far fa-file-excel","aria-hidden":"true"}),PowerPoint:m.a.createElement("i",{className:"far fa-file-powerpoint","aria-hidden":"true"}),Text:m.a.createElement("i",{className:"far fa-file-alt","aria-hidden":"true"}),PDF:m.a.createElement("i",{className:"far fa-file-pdf","aria-hidden":"true"}),Rename:m.a.createElement("i",{className:"fas fa-i-cursor","aria-hidden":"true"}),Folder:m.a.createElement("i",{className:"far fa-folder","aria-hidden":"true"}),FolderOpen:m.a.createElement("i",{className:"far fa-folder-open","aria-hidden":"true"}),Delete:m.a.createElement("i",{className:"far fa-trash-alt","aria-hidden":"true"}),Loading:m.a.createElement("i",{className:"fas fa-circle-notch fa-spin","aria-hidden":"true"}),Download:m.a.createElement("i",{className:"fas fa-download","aria-hidden":"true"})};default:console.warn("Could not find config for version "+e,"Accepted versions are: 4, 5","Please make an issue in `react-object-list` to fix this.")}};t.default=Pt}])}));